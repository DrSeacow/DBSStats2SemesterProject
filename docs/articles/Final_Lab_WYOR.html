<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Final_Lab_WYOR • DBSStats2SemesterProject</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Final_Lab_WYOR">
<meta property="og:description" content="DBSStats2SemesterProject">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DBSStats2SemesterProject</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/About.html">About</a>
    </li>
    <li>
      <a href="../articles/Final_Lab_WYOR.html">Final_Lab_WYOR</a>
    </li>
    <li>
      <a href="../articles/Lab1.html">Lab1</a>
    </li>
    <li>
      <a href="../articles/Lab10_NestedDesigns.html">Lab10_NestedDesigns</a>
    </li>
    <li>
      <a href="../articles/Lab2.html">Lab2</a>
    </li>
    <li>
      <a href="../articles/Lab3.html">Lab3</a>
    </li>
    <li>
      <a href="../articles/Lab4_ANOVA.html">Lab4</a>
    </li>
    <li>
      <a href="../articles/Lab5a.html">Lab5a</a>
    </li>
    <li>
      <a href="../articles/Lab6_OrthNonOrthContrasts.html">Lab6</a>
    </li>
    <li>
      <a href="../articles/Lab7_FactorialAnova.html">Lab7_FactorialAnova</a>
    </li>
    <li>
      <a href="../articles/Lab8_FactorialAnova_Pt2_w_Contrasts.html">Lab8_FactorialAnova_Pt2_w_Contrasts</a>
    </li>
    <li>
      <a href="../articles/Lab9_RMAnova.html">Lab9_RMAnova</a>
    </li>
    <li>
      <a href="../articles/R_Basics_Practicals.html">R Basics</a>
    </li>
    <li>
      <a href="../articles/slide_deck.html">Intro to Immuno Analyze - IO Slide Deck</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Final_Lab_WYOR</h1>
            
      
      
      <div class="hidden name"><code>Final_Lab_WYOR.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="note-this-is-effectively-a-condensed-version-of-all-the-functions-used-in-my-immuno-analyze-package-">Note: This is effectively a condensed version of all the functions used in my “immuno.analyze” package.<a class="anchor" aria-label="anchor" href="#note-this-is-effectively-a-condensed-version-of-all-the-functions-used-in-my-immuno-analyze-package-"></a>
</h3>
</div>
<div class="section level3">
<h3 id="this-function-requires-loading-of-the-stringr-tidyr-and-dplyr-packages-">This function requires loading of the “stringr,” “Tidyr,” and “dplyr” packages.<a class="anchor" aria-label="anchor" href="#this-function-requires-loading-of-the-stringr-tidyr-and-dplyr-packages-"></a>
</h3>
</div>
<div class="section level3">
<h3 id="this-function-assumes-that-when-imaging-your-brain-tissue-a-group-specific-tag-is-put-at-the-beginning-of-the-file-name-for-each-of-the-groups--the-first-of-these-will-ultimately-become-the-same-thing-input-under-the-first_group-term-">This function assumes that, when imaging your brain tissue, a group-specific tag is put at the beginning of the file name for each of the groups. The first of these will ultimately become the same thing input under the “first_group” term.<a class="anchor" aria-label="anchor" href="#this-function-assumes-that-when-imaging-your-brain-tissue-a-group-specific-tag-is-put-at-the-beginning-of-the-file-name-for-each-of-the-groups--the-first-of-these-will-ultimately-become-the-same-thing-input-under-the-first_group-term-"></a>
</h3>
</div>
<div class="section level3">
<h3 id="it-is-recommended-that-groups-are-code-named-for-anonymity-of-condition-to-avoid-experimenter-bias-along-all-steps-of-the-immunohistochemistry-process-if-possible-">It is recommended that groups are code-named for anonymity of condition to avoid experimenter bias, along all steps of the immunohistochemistry process, if possible.<a class="anchor" aria-label="anchor" href="#it-is-recommended-that-groups-are-code-named-for-anonymity-of-condition-to-avoid-experimenter-bias-along-all-steps-of-the-immunohistochemistry-process-if-possible-"></a>
</h3>
</div>
<div class="section level3">
<h3 id="see-the-immuno-analyze-package-for-working-versions-of-these-functions--documentation-for-this-package-is-available-at-httpsdrseacow-github-ioimmuno-analyze--">See the “immuno.analyze” package for working versions of these functions. Documentation for this package is available at <a href="https://drseacow.github.io/immuno.analyze/" class="external-link uri">https://drseacow.github.io/immuno.analyze/</a> .<a class="anchor" aria-label="anchor" href="#see-the-immuno-analyze-package-for-working-versions-of-these-functions--documentation-for-this-package-is-available-at-httpsdrseacow-github-ioimmuno-analyze--"></a>
</h3>
</div>
<div class="section level3">
<h3 id="percent-area-analysis-averaging-over-coronal-plane-of-tissue">Percent area analysis, averaging over coronal plane of tissue<a class="anchor" aria-label="anchor" href="#percent-area-analysis-averaging-over-coronal-plane-of-tissue"></a>
</h3>
<p>overall.percent.area &lt;- function(graph_name, DV, first_group, second_group, n_per_group, data = x){</p>
<p>library(stringr) library(dplyr) library(tidyr) library(ggplot2) library(patchwork)</p>
<p>immunot_data &lt;- as.data.frame(read.csv(data, header = TRUE, sep = “,”, dec = “.”)) %&gt;% select(c(“Label”, “Mean”, “X.Area”)) immunot_data &lt;- separate(immunot_data, “Label”, c(“Group”, NA, “Subject”, NA, “Plane”, “Side”, NA, NA, NA, NA, NA, NA), “_“)</p>
<p>gp1_grand_mean &lt;- mean(immunot_data[immunot_data$Group == first_group, ‘X.Area’]) gp2_grand_mean &lt;- mean(immunot_data[immunot_data$Group == second_group, ‘X.Area’])</p>
<p>gp1_grand_sterr &lt;- sd(immunot_data[immunot_data$Group == first_group, ‘X.Area’]) / sqrt(n_per_group) gp2_grand_sterr &lt;- sd(immunot_data[immunot_data$Group == second_group, ‘X.Area’]) / sqrt(n_per_group)</p>
<p>cross_plane_sterrs &lt;- c(gp1_grand_sterr, gp2_grand_sterr)</p>
<p>cross_plane_compare &lt;- as.numeric(c(gp1_grand_mean, gp2_grand_mean))</p>
<p>graph_df_without_plane &lt;- tibble(Group = c(first_group, second_group), DV = cross_plane_compare)</p>
<p>plot &lt;- ggplot(graph_df_without_plane, aes(x = Group, y = DV, ylab = DV)) + geom_bar(stat = “identity”) + geom_errorbar(aes(ymin = (DV - cross_plane_sterrs), ymax = (DV + cross_plane_sterrs))) + ggtitle(graph_name) + ylab(DV)</p>
<p>gp1_grand_values &lt;- c(immunot_data[immunot_data$Group == first_group, ‘X.Area’]) gp2_grand_values &lt;- c(immunot_data[immunot_data$Group == second_group, ‘X.Area’])</p>
<p>overall_t &lt;- t.test(gp1_grand_values, gp2_grand_values, var.equal = TRUE)</p>
<p>analysis_display &lt;- print(overall_t) analysis &lt;- return(list(analysis_display, plot))</p>
<p>}</p>
</div>
<div class="section level3">
<h3 id="percent-area-analyses-differentiating-between-three-coronal-planes-of-tissue">Percent area analyses, differentiating between three coronal planes of tissue<a class="anchor" aria-label="anchor" href="#percent-area-analyses-differentiating-between-three-coronal-planes-of-tissue"></a>
</h3>
<p>percent.area.plane &lt;- function(graph_name_1, graph_name_2, graph_name_3, DV, first_group, second_group, n_per_group, data = x){</p>
<p>library(stringr) library(dplyr) library(tidyr) library(ggplot2) library(patchwork)</p>
<p>immunot_data &lt;- as.data.frame(read.csv(data, header = TRUE, sep = “,”, dec = “.”)) %&gt;% select(c(“Label”, “Mean”, “X.Area”)) immunot_data &lt;- separate(immunot_data, “Label”, c(“Group”, NA, “Subject”, NA, “Plane”, “Side”, NA, NA, NA, NA, NA, NA), “_“)</p>
<p>means_by_plane &lt;- tibble(aggregate(immunot_data<span class="math inline">\(X.Area, FUN = mean, by = list(Plane = immunot_data\)</span>Plane, Group = immunot_data$Group)))</p>
<p>sds_by_plane &lt;- tibble(aggregate(immunot_data<span class="math inline">\(X.Area, FUN = sd, by = list(Plane = immunot_data\)</span>Plane, Group = immunot_data$Group)))</p>
<p>gp1_ant &lt;- immunot_data[immunot_data<span class="math inline">\(Group == first_group &amp; immunot_data\)</span>Plane == “Ant”, ] aa &lt;- as.vector(t(gp1_ant %&gt;% select(X.Area))) gp2_ant &lt;- immunot_data[immunot_data<span class="math inline">\(Group == second_group &amp; immunot_data\)</span>Plane == “Ant”, ] ab &lt;- as.vector(t(gp2_ant %&gt;% select(X.Area)))</p>
<p>gp1_med &lt;- immunot_data[immunot_data<span class="math inline">\(Group == first_group &amp; immunot_data\)</span>Plane == “Med”, ] ba &lt;- as.vector(t(gp1_med %&gt;% select(X.Area))) gp2_med &lt;- immunot_data[immunot_data<span class="math inline">\(Group == second_group &amp; immunot_data\)</span>Plane == “Med”, ] bb &lt;- as.vector(t(gp2_med %&gt;% select(X.Area)))</p>
<p>gp1_pos &lt;- immunot_data[immunot_data<span class="math inline">\(Group == first_group &amp; immunot_data\)</span>Plane == “Pos”, ] ca &lt;- as.vector(t(gp1_pos %&gt;% select(X.Area))) gp2_pos &lt;- immunot_data[immunot_data<span class="math inline">\(Group == second_group &amp; immunot_data\)</span>Plane == “Pos”, ] cb &lt;- as.vector(t(gp2_pos %&gt;% select(X.Area)))</p>
<p>gp1_mean_ant &lt;- means_by_plane[1,3] gp1_mean_med &lt;- means_by_plane[2,3] gp1_mean_pos &lt;- means_by_plane[3,3] gp2_mean_ant &lt;- means_by_plane[4,3] gp2_mean_med &lt;- means_by_plane[5,3] gp2_mean_pos &lt;- means_by_plane[6,3]</p>
<p>gp1_sterr_ant &lt;- sds_by_plane[1,3] / sqrt(n_per_group) gp1_sterr_med &lt;- sds_by_plane[2,3] / sqrt(n_per_group) gp1_sterr_pos &lt;- sds_by_plane[3,3] / sqrt(n_per_group) gp2_sterr_ant &lt;- sds_by_plane[4,3] / sqrt(n_per_group) gp2_sterr_med &lt;- sds_by_plane[5,3] / sqrt(n_per_group) gp2_sterr_pos &lt;- sds_by_plane[6,3] / sqrt(n_per_group)</p>
<p>ant_compare &lt;- as.numeric(c(gp1_mean_ant, gp2_mean_ant))</p>
<p>med_compare &lt;- as.numeric(c(gp1_mean_med, gp2_mean_med))</p>
<p>pos_compare &lt;- as.numeric(c(gp1_mean_pos, gp2_mean_pos))</p>
<p>ant_sterrs &lt;- as.numeric(c(gp1_sterr_ant, gp2_sterr_ant))</p>
<p>med_sterrs &lt;- as.numeric(c(gp1_sterr_med, gp2_sterr_med))</p>
<p>pos_sterrs &lt;- as.numeric(c(gp1_sterr_pos, gp2_sterr_pos))</p>
<p>graph_df_ant &lt;- tibble(Ant = rep(c(first_group, second_group)), DV = ant_compare)</p>
<p>graph_df_med &lt;- tibble(Med = rep(c(first_group, second_group)), DV = med_compare)</p>
<p>graph_df_pos &lt;- tibble(Pos = rep(c(first_group, second_group)), DV = pos_compare)</p>
<p>a &lt;- ggplot(graph_df_ant, aes(x = Ant, y = DV)) + geom_bar(stat = “identity”) + geom_errorbar(aes(ymin = (DV - ant_sterrs), ymax = (DV + ant_sterrs))) + ggtitle(graph_name_1) + ylab(DV) m &lt;- ggplot(graph_df_med, aes(x = Med, y = DV)) + geom_bar(stat = “identity”) + geom_errorbar(aes(ymin = (DV - med_sterrs), ymax = (DV + med_sterrs))) + ggtitle(graph_name_2) + ylab(DV) p &lt;- ggplot(graph_df_pos, aes(x = Pos, y = DV)) + geom_bar(stat = “identity”) + geom_errorbar(aes(ymin = (DV - pos_sterrs), ymax = (DV + pos_sterrs))) + ggtitle(graph_name_3) + ylab(DV)</p>
<p>ant_t &lt;- t.test(aa, ab, var.equal = TRUE)<span class="math inline">\(p.value  med_t &lt;- t.test(ba, bb, var.equal = TRUE)\)</span>p.value pos_t &lt;- t.test(ca, cb, var.equal = TRUE)$p.value</p>
<p>analysis_list &lt;- c(ant_t, med_t, pos_t) plot &lt;- a+m+p</p>
<p>analysis &lt;- return(list(analysis_list, plot))</p>
<p>}</p>
</div>
<div class="section level3">
<h3 id="cell-count-analyses-averaging-over-coronal-plane-of-tissue">Cell count analyses, averaging over coronal plane of tissue<a class="anchor" aria-label="anchor" href="#cell-count-analyses-averaging-over-coronal-plane-of-tissue"></a>
</h3>
<p>overall.cell.counts &lt;- function(graph_name, DV, first_group, second_group, n_per_group, data = x){</p>
<p>library(stringr) library(dplyr) library(tidyr) library(ggplot2) library(patchwork)</p>
<p>immunot_data &lt;- as.data.frame(read.csv(data, header = TRUE, sep = “,”, dec = “.”)) %&gt;% select(c(“Label”, “Mean”, “X.Area”)) immunot_data &lt;- separate(immunot_data, “Label”, c(“Group”, NA, “Subject”, NA, “Plane”, “Side”, NA), “_“)</p>
<p>values_by_group &lt;- tibble(aggregate(immunot_data<span class="math inline">\(Plane, FUN = length, by = list(Plane = immunot_data\)</span>Plane, Group = immunot_data<span class="math inline">\(Group, immunot_data\)</span>Subject)))</p>
<p>values_by_group_avg_by_plane &lt;- tibble(aggregate(values_by_group<span class="math inline">\(x, FUN = mean, by = list(Group = values_by_group\)</span>Group, Subject = values_by_group$Group.3)))</p>
<p>gp1_values &lt;- as.vector(values_by_group_avg_by_plane<span class="math inline">\(x[values_by_group_avg_by_plane\)</span>Group == first_group]) gp2_values &lt;- as.vector(values_by_group_avg_by_plane<span class="math inline">\(x[values_by_group_avg_by_plane\)</span>Group == second_group])</p>
<p>gp1_grand_mean &lt;- sum(values_by_group_avg_by_plane[values_by_group_avg_by_plane$Group == first_group, ‘x’]) / n_per_group gp2_grand_mean &lt;- sum(values_by_group_avg_by_plane[values_by_group_avg_by_plane$Group == second_group, ‘x’]) / n_per_group</p>
<p>gp1_sterr &lt;- sd(gp1_values) / sqrt(n_per_group) gp2_sterr &lt;- sd(gp2_values) / sqrt(n_per_group)</p>
<p>cross_plane_sds &lt;- c(gp1_sterr, gp2_sterr)</p>
<p>cross_plane_compare &lt;- as.numeric(c(gp1_grand_mean, gp2_grand_mean))</p>
<p>graph_df_without_plane &lt;- tibble(Group = c(first_group, second_group), DV = cross_plane_compare)</p>
<p>plot &lt;- ggplot(graph_df_without_plane, aes(x = Group, y = DV)) + geom_bar(stat = “identity”) + geom_errorbar(aes(ymin = (DV - cross_plane_sds), ymax = (DV + cross_plane_sds))) + ggtitle(graph_name) + ylab(DV)</p>
<p>overall_t &lt;- t.test(gp1_values, gp2_values, var.equal = TRUE) overall_t</p>
<p>analysis_display &lt;- print(overall_t) return(plot)</p>
<p>}</p>
</div>
<div class="section level3">
<h3 id="cell-count-analyses-differentiating-between-three-coronal-planes-of-tissue">Cell count analyses, differentiating between three coronal planes of tissue<a class="anchor" aria-label="anchor" href="#cell-count-analyses-differentiating-between-three-coronal-planes-of-tissue"></a>
</h3>
<p>cell.counts.plane &lt;- function(graph_name_1, graph_name_2, graph_name_3, DV, first_group, second_group, n_per_group, data = x){</p>
<p>library(stringr) library(dplyr) library(tidyr) library(ggplot2) library(patchwork)</p>
<p>immunot_data &lt;- as.data.frame(read.csv(data, header = TRUE, sep = “,”, dec = “.”)) %&gt;% select(c(“Label”, “Mean”, “X.Area”)) immunot_data &lt;- separate(immunot_data, “Label”, c(“Group”, NA, “Subject”, NA, “Plane”, “Side”, NA), “_“)</p>
<p>counts_by_plane &lt;- tibble(aggregate(immunot_data<span class="math inline">\(Plane, FUN = length, by = list(Plane = immunot_data\)</span>Plane, Group = immunot_data<span class="math inline">\(Group, immunot_data\)</span>Subject)))</p>
<p>gp1_ant &lt;- counts_by_plane[counts_by_plane<span class="math inline">\(Group == first_group &amp; counts_by_plane\)</span>Plane == “Ant”, ] aa &lt;- as.vector(t(gp1_ant %&gt;% select(x))) gp2_ant &lt;- counts_by_plane[counts_by_plane<span class="math inline">\(Group == second_group &amp; counts_by_plane\)</span>Plane == “Ant”, ] ab &lt;- as.vector(t(gp2_ant %&gt;% select(x)))</p>
<p>gp1_med &lt;- counts_by_plane[counts_by_plane<span class="math inline">\(Group == first_group &amp; counts_by_plane\)</span>Plane == “Med”, ] ba &lt;- as.vector(t(gp1_med %&gt;% select(x))) gp2_med &lt;- counts_by_plane[counts_by_plane<span class="math inline">\(Group == second_group &amp; counts_by_plane\)</span>Plane == “Med”, ] bb &lt;- as.vector(t(gp2_med %&gt;% select(x)))</p>
<p>gp1_pos &lt;- counts_by_plane[counts_by_plane<span class="math inline">\(Group == first_group &amp; counts_by_plane\)</span>Plane == “Pos”, ] ca &lt;- as.vector(t(gp1_pos %&gt;% select(x))) gp2_pos &lt;- counts_by_plane[counts_by_plane<span class="math inline">\(Group == second_group &amp; counts_by_plane\)</span>Plane == “Pos”, ] cb &lt;- as.vector(t(gp2_pos %&gt;% select(x)))</p>
<p>plane_count &lt;- tibble(Group = rep(rep(c(“gp1”, “gp2”), each = 6), 3), Plane = rep(c(“ant”, “med”, “pos”), each = 12), Counts = c(aa, ab, ba, bb, ca, cb) )</p>
<p>means_by_plane &lt;- aggregate(counts_by_plane<span class="math inline">\(x, FUN = mean, by = list(Plane = counts_by_plane\)</span>Plane, Group = counts_by_plane$Group))</p>
<p>sds_by_plane &lt;- tibble(aggregate(counts_by_plane<span class="math inline">\(x, FUN = sd, by = list(Plane = counts_by_plane\)</span>Plane, Group = counts_by_plane$Group)))</p>
<p>gp1_mean_ant &lt;- means_by_plane[1,3] gp1_mean_med &lt;- means_by_plane[2,3] gp1_mean_pos &lt;- means_by_plane[3,3] gp2_mean_ant &lt;- means_by_plane[4,3] gp2_mean_med &lt;- means_by_plane[5,3] gp2_mean_pos &lt;- means_by_plane[6,3]</p>
<p>gp1_sterr_ant &lt;- as.numeric(sds_by_plane[1,3]) / sqrt(length(n_per_group)) gp1_sterr_med &lt;- as.numeric(sds_by_plane[2,3]) / sqrt(length(n_per_group)) gp1_sterr_pos &lt;- as.numeric(sds_by_plane[3,3]) / sqrt(length(n_per_group)) gp2_sterr_ant &lt;- as.numeric(sds_by_plane[4,3]) / sqrt(length(n_per_group)) gp2_sterr_med &lt;- as.numeric(sds_by_plane[5,3]) / sqrt(length(n_per_group)) gp2_sterr_pos &lt;- as.numeric(sds_by_plane[6,3]) / sqrt(length(n_per_group))</p>
<p>ant_compare &lt;- c(gp1_mean_ant, gp2_mean_ant)</p>
<p>med_compare &lt;- c(gp1_mean_med, gp2_mean_med)</p>
<p>pos_compare &lt;- c(gp1_mean_pos, gp2_mean_pos)</p>
<p>ant_sterrs &lt;- as.numeric(c(gp1_sterr_ant, gp2_sterr_ant))</p>
<p>med_sterrs &lt;- as.numeric(c(gp1_sterr_med, gp2_sterr_med))</p>
<p>pos_sterrs &lt;- as.numeric(c(gp1_sterr_pos, gp2_sterr_pos))</p>
<p>graph_df_ant &lt;- tibble(Ant = rep(c(first_group, second_group)), DV = ant_compare)</p>
<p>graph_df_med &lt;- tibble(Med = rep(c(first_group, second_group)), DV = med_compare)</p>
<p>graph_df_pos &lt;- tibble(Pos = rep(c(first_group, second_group)), DV = pos_compare)</p>
<p>a &lt;- ggplot(graph_df_ant, aes(x = Ant, y = ant_compare)) + geom_bar(stat = “identity”) + geom_errorbar(aes(ymin = (ant_compare - ant_sterrs), ymax = (ant_compare + ant_sterrs))) + ggtitle(graph_name_1) + ylab(DV)</p>
<p>m &lt;- ggplot(graph_df_med, aes(x = Med, y = DV)) + geom_bar(stat = “identity”) + geom_errorbar(aes(ymin = (med_compare - med_sterrs), ymax = (med_compare + med_sterrs))) + ggtitle(graph_name_2) + ylab(DV)</p>
<p>p &lt;- ggplot(graph_df_pos, aes(x = Pos, y = DV)) + geom_bar(stat = “identity”) + geom_errorbar(aes(ymin = (pos_compare - pos_sterrs), ymax = (pos_compare + pos_sterrs))) + ggtitle(graph_name_3) + ylab(DV)</p>
<p>ant_t &lt;- t.test(aa, ab, var.equal = TRUE) med_t &lt;- t.test(ba, bb, var.equal = TRUE) pos_t &lt;- t.test(ca, cb, var.equal = TRUE)</p>
<p>analysis_list &lt;- c(ant_t<span class="math inline">\(p.value, med_t\)</span>p.value, pos_t$p.value)</p>
<p>plot &lt;- a+m+p</p>
<p>return(list(analysis_list, plot))</p>
<p>}</p>
</div>
<div class="section level3">
<h3 id="mean-cell-intensity-analyses-averging-over-coronal-plane-of-tissue">Mean cell intensity analyses, averging over coronal plane of tissue<a class="anchor" aria-label="anchor" href="#mean-cell-intensity-analyses-averging-over-coronal-plane-of-tissue"></a>
</h3>
<p>overall.intensity &lt;- function(graph_name, DV, first_group, second_group, n_per_group, data = x){</p>
<p>immunot_data &lt;- as.data.frame(read.csv(data, header = TRUE, sep = “,”, dec = “.”)) %&gt;% select(c(“Label”, “Mean”, “X.Area”)) immunot_data &lt;- separate(immunot_data, “Label”, c(“Group”, NA, “Subject”, NA, “Plane”, “Side”, NA), “_“)</p>
<p>gp1_grand_mean &lt;- mean(immunot_data[immunot_data$Group == first_group, ‘Mean’]) gp2_grand_mean &lt;- mean(immunot_data[immunot_data$Group == second_group, ‘Mean’])</p>
<p>gp1_grand_sterr &lt;- sd(immunot_data[immunot_data$Group == first_group, ‘Mean’]) / sqrt(n_per_group) gp2_grand_sterr &lt;- sd(immunot_data[immunot_data$Group == second_group, ‘Mean’]) / sqrt(n_per_group)</p>
<p>cross_plane_sterr &lt;- c(gp1_grand_sterr, gp2_grand_sterr)</p>
<p>cross_plane_compare &lt;- as.numeric(c(gp1_grand_mean, gp2_grand_mean))</p>
<p>graph_df_without_plane &lt;- tibble(Group = c(first_group, second_group), DV = cross_plane_compare)</p>
<p>plot &lt;- ggplot(graph_df_without_plane, aes(x = Group, y = cross_plane_compare)) + geom_bar(stat = “identity”) + geom_errorbar(aes(ymin = (cross_plane_compare - cross_plane_sterr), ymax = (cross_plane_compare + cross_plane_sterr))) + ggtitle(graph_name) + ylab(DV)</p>
<p>values_by_group &lt;- tibble(aggregate(immunot_data<span class="math inline">\(Mean, FUN = mean, by = list(Group = immunot_data\)</span>Group, Subject = immunot_data$Subject)))</p>
<p>values_by_group_avg_by_plane &lt;- tibble(aggregate(values_by_group<span class="math inline">\(x, FUN = mean, by = list(Group = values_by_group\)</span>Group, Subject = values_by_group$Subject)))</p>
<p>gp1_values &lt;- as.vector(values_by_group<span class="math inline">\(x[values_by_group\)</span>Group == first_group]) gp2_values &lt;- as.vector(values_by_group<span class="math inline">\(x[values_by_group\)</span>Group == second_group])</p>
<p>overall_t &lt;- t.test(gp1_values, gp2_values, var.equal = TRUE) return(list(overall_t, plot))</p>
<p>}</p>
</div>
<div class="section level3">
<h3 id="mean-cell-intensity-analyses-differentiating-between-three-coronal-planes-of-tissue">Mean cell intensity analyses, differentiating between three coronal planes of tissue<a class="anchor" aria-label="anchor" href="#mean-cell-intensity-analyses-differentiating-between-three-coronal-planes-of-tissue"></a>
</h3>
<p>intensity.plane &lt;- function(graph_name_1, graph_name_2, graph_name_3, DV, first_group, second_group, n_per_group, data = x){</p>
<p>immunot_data &lt;- as.data.frame(read.csv(data, header = TRUE, sep = “,”, dec = “.”)) %&gt;% select(c(“Label”, “Mean”, “X.Area”)) immunot_data &lt;- separate(immunot_data, “Label”, c(“Group”, NA, “Subject”, NA, “Plane”, “Side”, NA), “_“)</p>
<p>means_by_plane &lt;- tibble(aggregate(immunot_data<span class="math inline">\(Mean, FUN = mean, by = list(Plane = immunot_data\)</span>Plane, Group = immunot_data$Group)))</p>
<p>sds_by_plane &lt;- tibble(aggregate(immunot_data<span class="math inline">\(Mean, FUN = sd, by = list(Plane = immunot_data\)</span>Plane, Group = immunot_data$Group)))</p>
<p>values_by_plane &lt;- tibble(aggregate(immunot_data<span class="math inline">\(Mean, FUN = mean, by = list(Plane = immunot_data\)</span>Plane, Group = immunot_data<span class="math inline">\(Group, Subject = immunot_data\)</span>Subject)))</p>
<p>gp1_ant &lt;- values_by_plane[values_by_plane<span class="math inline">\(Group == first_group &amp; values_by_plane\)</span>Plane == “Ant”, ] aa &lt;- as.vector(t(gp1_ant %&gt;% select(x))) gp2_ant &lt;- values_by_plane[values_by_plane<span class="math inline">\(Group == second_group &amp; values_by_plane\)</span>Plane == “Ant”, ] ab &lt;- as.vector(t(gp2_ant %&gt;% select(x)))</p>
<p>gp1_med &lt;- values_by_plane[values_by_plane<span class="math inline">\(Group == first_group &amp; values_by_plane\)</span>Plane == “Med”, ] ba &lt;- as.vector(t(gp1_med %&gt;% select(x))) gp2_med &lt;- values_by_plane[values_by_plane<span class="math inline">\(Group == second_group &amp; values_by_plane\)</span>Plane == “Med”, ] bb &lt;- as.vector(t(gp2_med %&gt;% select(x)))</p>
<p>gp1_pos &lt;- values_by_plane[values_by_plane<span class="math inline">\(Group == first_group &amp; values_by_plane\)</span>Plane == “Pos”, ] ca &lt;- as.vector(t(gp1_pos %&gt;% select(x))) gp2_pos &lt;- values_by_plane[values_by_plane<span class="math inline">\(Group == second_group &amp; values_by_plane\)</span>Plane == “Pos”, ] cb &lt;- as.vector(t(gp2_pos %&gt;% select(x)))</p>
<p>gp1_mean_ant &lt;- means_by_plane[1,3] gp1_mean_med &lt;- means_by_plane[2,3] gp1_mean_pos &lt;- means_by_plane[3,3] gp2_mean_ant &lt;- means_by_plane[4,3] gp2_mean_med &lt;- means_by_plane[5,3] gp2_mean_pos &lt;- means_by_plane[6,3]</p>
<p>gp1_sterr_ant &lt;- sds_by_plane[1,3] / sqrt(n_per_group) gp1_sterr_med &lt;- sds_by_plane[2,3] / sqrt(n_per_group) gp1_sterr_pos &lt;- sds_by_plane[3,3] / sqrt(n_per_group) gp2_sterr_ant &lt;- sds_by_plane[4,3] / sqrt(n_per_group) gp2_sterr_med &lt;- sds_by_plane[5,3] / sqrt(n_per_group) gp2_sterr_pos &lt;- sds_by_plane[6,3] / sqrt(n_per_group)</p>
<p>ant_compare &lt;- as.numeric(c(gp1_mean_ant, gp2_mean_ant))</p>
<p>med_compare &lt;- as.numeric(c(gp1_mean_med, gp2_mean_med))</p>
<p>pos_compare &lt;- as.numeric(c(gp1_mean_pos, gp2_mean_pos))</p>
<p>ant_sterrs &lt;- as.numeric(c(gp1_sterr_ant, gp2_sterr_ant))</p>
<p>med_sterrs &lt;- as.numeric(c(gp1_sterr_med, gp2_sterr_med))</p>
<p>pos_sterrs &lt;- as.numeric(c(gp1_sterr_pos, gp2_sterr_pos))</p>
<p>graph_df_ant &lt;- tibble(Ant = rep(c(first_group, second_group)), DV = ant_compare)</p>
<p>graph_df_med &lt;- tibble(Med = rep(c(first_group, second_group)), DV = med_compare)</p>
<p>graph_df_pos &lt;- tibble(Pos = rep(c(first_group, second_group)), DV = pos_compare)</p>
<p>a &lt;- ggplot(graph_df_ant, aes(x = Ant, y = ant_compare)) + geom_bar(stat = “identity”) + geom_errorbar(aes(ymin = (ant_compare - ant_sterrs), ymax = (ant_compare + ant_sterrs))) + ggtitle(graph_name_1) + ylab(DV)</p>
<p>m &lt;- ggplot(graph_df_med, aes(x = Med, y = med_compare)) + geom_bar(stat = “identity”) + geom_errorbar(aes(ymin = (med_compare - med_sterrs), ymax = (med_compare + med_sterrs))) + ggtitle(graph_name_2) + ylab(DV)</p>
<p>p &lt;- ggplot(graph_df_pos, aes(x = Pos, y = pos_compare)) + geom_bar(stat = “identity”) + geom_errorbar(aes(ymin = (pos_compare - pos_sterrs), ymax = (pos_compare + pos_sterrs))) + ggtitle(graph_name_3) + ylab(DV)</p>
<p>ant_t &lt;- t.test(aa, ab, var.equal = TRUE) med_t &lt;- t.test(ba, bb, var.equal = TRUE) pos_t &lt;- t.test(ca, cb, var.equal = TRUE)</p>
<p>analysis_list &lt;- c(ant_t<span class="math inline">\(p.value, med_t\)</span>p.value, pos_t$p.value)</p>
<p>plot &lt;- a+m+p</p>
<p>return(list(analysis_list, plot))</p>
<p>}</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">DBSStats2Labs</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Dan Siegel.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
