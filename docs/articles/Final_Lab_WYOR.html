<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Final_Lab_WYOR • DBSStats2SemesterProject</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Final_Lab_WYOR">
<meta property="og:description" content="DBSStats2SemesterProject">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DBSStats2SemesterProject</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/About.html">About</a>
    </li>
    <li>
      <a href="../articles/Aboutreviews.html">Aboutreviews</a>
    </li>
    <li>
      <a href="../articles/Final_Lab_WYOR.html">Final_Lab_WYOR</a>
    </li>
    <li>
      <a href="../articles/Lab1.html">Lab1</a>
    </li>
    <li>
      <a href="../articles/Lab10_NestedDesigns.html">Lab10_NestedDesigns</a>
    </li>
    <li>
      <a href="../articles/Lab2.html">Lab2</a>
    </li>
    <li>
      <a href="../articles/Lab3.html">Lab3</a>
    </li>
    <li>
      <a href="../articles/Lab4_ANOVA.html">Lab4</a>
    </li>
    <li>
      <a href="../articles/Lab5a.html">Lab5a</a>
    </li>
    <li>
      <a href="../articles/Lab6_OrthNonOrthContrasts.html">Lab6</a>
    </li>
    <li>
      <a href="../articles/Lab7_FactorialAnova.html">Lab7_FactorialAnova</a>
    </li>
    <li>
      <a href="../articles/Lab8_FactorialAnova_Pt2_w_Contrasts.html">Lab8_FactorialAnova_Pt2_w_Contrasts</a>
    </li>
    <li>
      <a href="../articles/Lab9_RMAnova.html">Lab9_RMAnova</a>
    </li>
    <li>
      <a href="../articles/Practicals_for_Final.html">Practicals_for_Final</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Final_Lab_WYOR</h1>
            
      
      
      <div class="hidden name"><code>Final_Lab_WYOR.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="note-this-is-effectively-a-condensed-version-of-all-the-functions-used-in-my-immuno-analyze-package-">Note: This is effectively a condensed version of all the functions used in my “immuno.analyze” package.<a class="anchor" aria-label="anchor" href="#note-this-is-effectively-a-condensed-version-of-all-the-functions-used-in-my-immuno-analyze-package-"></a>
</h3>
</div>
<div class="section level3">
<h3 id="this-function-requires-loading-of-the-stringr-tidyr-and-dplyr-packages-">This function requires loading of the “stringr,” “Tidyr,” and “dplyr” packages.<a class="anchor" aria-label="anchor" href="#this-function-requires-loading-of-the-stringr-tidyr-and-dplyr-packages-"></a>
</h3>
</div>
<div class="section level3">
<h3 id="this-function-assumes-that-when-imaging-your-brain-tissue-a-group-specific-tag-is-put-at-the-beginning-of-the-file-name-for-each-of-the-groups--the-first-of-these-will-ultimately-become-the-same-thing-input-under-the-first_group-term-">This function assumes that, when imaging your brain tissue, a group-specific tag is put at the beginning of the file name for each of the groups. The first of these will ultimately become the same thing input under the “first_group” term.<a class="anchor" aria-label="anchor" href="#this-function-assumes-that-when-imaging-your-brain-tissue-a-group-specific-tag-is-put-at-the-beginning-of-the-file-name-for-each-of-the-groups--the-first-of-these-will-ultimately-become-the-same-thing-input-under-the-first_group-term-"></a>
</h3>
</div>
<div class="section level3">
<h3 id="it-is-recommended-that-groups-are-code-named-for-anonymity-of-condition-to-avoid-experimenter-bias-along-all-steps-of-the-immunohistochemistry-process-if-possible-">It is recommended that groups are code-named for anonymity of condition to avoid experimenter bias, along all steps of the immunohistochemistry process, if possible.<a class="anchor" aria-label="anchor" href="#it-is-recommended-that-groups-are-code-named-for-anonymity-of-condition-to-avoid-experimenter-bias-along-all-steps-of-the-immunohistochemistry-process-if-possible-"></a>
</h3>
</div>
<div class="section level3">
<h3 id="for-area-percentage-analyses-not-split-by-plane-averages-across-all-planes-and-uses-unpaired-samples-t-test">For area percentage analyses, not split by plane (averages across all planes and uses unpaired-samples t-test):<a class="anchor" aria-label="anchor" href="#for-area-percentage-analyses-not-split-by-plane-averages-across-all-planes-and-uses-unpaired-samples-t-test"></a>
</h3>
<p>immunot_percent &lt;- function(type, measure, region, first_group, second_group, n_per_group, data){</p>
<p>library(stringr) library(dplyr) library(tidyr) library(ggplot2) library(patchwork)</p>
<pre><code><span class="va">immunot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"percent_ps6_BLA.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span>, dec <span class="op">=</span> <span class="st">"."</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Label"</span>, <span class="st">"Mean"</span>, <span class="st">"X.Area"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">immunot_data</span> <span class="op">&lt;-</span> <span class="fu">separate</span><span class="op">(</span><span class="va">immunot_data</span>, <span class="st">"Label"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group"</span>, <span class="cn">NA</span>, <span class="st">"Subject"</span>, <span class="cn">NA</span>, <span class="st">"Plane"</span>, <span class="st">"Side"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="st">"_"</span><span class="op">)</span>

  <span class="va">gp1_grand_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">immunot_data</span><span class="op">[</span><span class="va">immunot_data</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">'Ctrl'</span>, <span class="st">'X.Area'</span><span class="op">]</span><span class="op">)</span>
  <span class="va">gp2_grand_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">immunot_data</span><span class="op">[</span><span class="va">immunot_data</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">'Switch'</span>, <span class="st">'X.Area'</span><span class="op">]</span><span class="op">)</span>
  
  <span class="va">gp1_grand_sterr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">immunot_data</span><span class="op">[</span><span class="va">immunot_data</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">'Ctrl'</span>, <span class="st">'X.Area'</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>
  <span class="va">gp2_grand_sterr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">immunot_data</span><span class="op">[</span><span class="va">immunot_data</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">'Switch'</span>, <span class="st">'X.Area'</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>
  
  <span class="va">cross_plane_sterrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gp1_grand_sterr</span>, <span class="va">gp2_grand_sterr</span><span class="op">)</span>

<span class="va">cross_plane_compare</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gp1_grand_mean</span>, <span class="va">gp2_grand_mean</span><span class="op">)</span><span class="op">)</span>

<span class="va">graph_df_without_plane</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ctrl"</span>, <span class="st">"Switch"</span><span class="op">)</span>,
                                Percent_PS6 <span class="op">=</span> <span class="va">cross_plane_compare</span><span class="op">)</span>
                                
<span class="fu">ggplot</span><span class="op">(</span><span class="va">graph_df_without_plane</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Group</span>, y <span class="op">=</span> <span class="va">Percent_PS6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="op">(</span><span class="va">Percent_PS6</span> <span class="op">-</span> <span class="va">cross_plane_sterrs</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="op">(</span><span class="va">Percent_PS6</span> <span class="op">+</span> <span class="va">cross_plane_sterrs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre>
<p>gp1_grand_values &lt;- c(immunot_data[immunot_data$Group == ‘Ctrl’, ‘X.Area’]) gp2_grand_values &lt;- c(immunot_data[immunot_data$Group == ‘Switch’, ‘X.Area’])</p>
<p>overall_t &lt;- t.test(gp1_grand_values, gp2_grand_values, var.equal = TRUE)</p>
<p>overall_t</p>
<p>ant_t &lt;- t.test(immunot_data)</p>
<p>}</p>
</div>
<div class="section level3">
<h3 id="for-area-percentage-analyses-split-by-plane-this-treats-plane-as-a-factor-in-two-way-factorial-anova">For area percentage analyses, split by plane (this treats “plane” as a factor in two-way factorial ANOVA):<a class="anchor" aria-label="anchor" href="#for-area-percentage-analyses-split-by-plane-this-treats-plane-as-a-factor-in-two-way-factorial-anova"></a>
</h3>
<p>immunot_percent &lt;- function(type, measure, region, first_group, n_per_group, data){</p>
<p>library(stringr) library(dplyr) library(tidyr) library(ggplot2) library(patchwork)</p>
<pre><code><span class="va">immunot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"percent_ps6_BLA.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span>, dec <span class="op">=</span> <span class="st">"."</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Label"</span>, <span class="st">"Mean"</span>, <span class="st">"X.Area"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">immunot_data</span> <span class="op">&lt;-</span> <span class="fu">separate</span><span class="op">(</span><span class="va">immunot_data</span>, <span class="st">"Label"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group"</span>, <span class="cn">NA</span>, <span class="st">"Subject"</span>, <span class="cn">NA</span>, <span class="st">"Plane"</span>, <span class="st">"Side"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="st">"_"</span><span class="op">)</span></code></pre>
<p>means_by_plane &lt;- tibble(aggregate(immunot_data<span class="math inline">\(X.Area, FUN = mean, by = list(Plane = immunot_data\)</span>Plane, Group = immunot_data$Group)))</p>
<p>sds_by_plane &lt;- tibble(aggregate(immunot_data<span class="math inline">\(X.Area, FUN = sd, by = list(Plane = immunot_data\)</span>Plane, Group = immunot_data$Group)))</p>
<pre><code><span class="va">gp1_mean_ant</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span>
<span class="va">gp1_mean_med</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span>
<span class="va">gp1_mean_pos</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">]</span>
<span class="va">gp2_mean_ant</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">3</span><span class="op">]</span>
<span class="va">gp2_mean_med</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">3</span><span class="op">]</span>
<span class="va">gp2_mean_pos</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">6</span>,<span class="fl">3</span><span class="op">]</span>

<span class="va">gp1_sterr_ant</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>
<span class="va">gp1_sterr_med</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>
<span class="va">gp1_sterr_pos</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>
<span class="va">gp2_sterr_ant</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>
<span class="va">gp2_sterr_med</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>
<span class="va">gp2_sterr_pos</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">6</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span></code></pre>
<p>ant_compare &lt;- as.numeric(c(gp1_mean_ant, gp2_mean_ant))</p>
<p>med_compare &lt;- as.numeric(c(gp1_mean_med, gp2_mean_med))</p>
<p>pos_compare &lt;- as.numeric(c(gp1_mean_pos, gp2_mean_pos))</p>
<p>ant_sterrs &lt;- as.numeric(c(gp1_sterr_ant, gp2_sterr_ant))</p>
<p>med_sterrs &lt;- as.numeric(c(gp1_sterr_med, gp2_sterr_med))</p>
<p>pos_sterrs &lt;- as.numeric(c(gp1_sterr_pos, gp2_sterr_pos))</p>
<p>graph_df_ant &lt;- tibble(Ant = rep(c(“Ctrl”, “Switch”)), Percent_PS6 = ant_compare)</p>
<p>graph_df_med &lt;- tibble(Med = rep(c(“Ctrl”, “Switch”)), Percent_PS6 = med_compare)</p>
<p>graph_df_pos &lt;- tibble(Pos = rep(c(“Ctrl”, “Switch”)), Percent_PS6 = pos_compare)</p>
<pre><code><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">graph_df_ant</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Ant</span>, y <span class="op">=</span> <span class="va">Percent_PS6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="op">(</span><span class="va">Percent_PS6</span> <span class="op">-</span> <span class="va">ant_sterrs</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="op">(</span><span class="va">Percent_PS6</span> <span class="op">+</span> <span class="va">ant_sterrs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">graph_df_med</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Med</span>, y <span class="op">=</span> <span class="va">Percent_PS6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="op">(</span><span class="va">Percent_PS6</span> <span class="op">-</span> <span class="va">med_sterrs</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="op">(</span><span class="va">Percent_PS6</span> <span class="op">+</span> <span class="va">med_sterrs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">graph_df_pos</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Pos</span>, y <span class="op">=</span> <span class="va">Percent_PS6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="op">(</span><span class="va">Percent_PS6</span> <span class="op">-</span> <span class="va">pos_sterrs</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="op">(</span><span class="va">Percent_PS6</span> <span class="op">+</span> <span class="va">pos_sterrs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">a</span><span class="op">+</span><span class="va">m</span><span class="op">+</span><span class="va">p</span></code></pre>
<p>plane_wise_anova &lt;- summary(aov(X.Area ~ Plane*Group, data = immunot_data)) plane_wise_anova</p>
<p>}</p>
</div>
<div class="section level3">
<h3 id="for-cell-count-analyses-combined-across-planes">For cell count analyses, combined across planes<a class="anchor" aria-label="anchor" href="#for-cell-count-analyses-combined-across-planes"></a>
</h3>
<p>immunot_percent &lt;- function(type, measure, region, first_group, n_per_group, data){</p>
<p>library(stringr) library(dplyr) library(tidyr) library(ggplot2) library(patchwork)</p>
<pre><code><span class="va">immunot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"outline_VTA.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span>, dec <span class="op">=</span> <span class="st">"."</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Label"</span>, <span class="st">"Mean"</span>, <span class="st">"X.Area"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">immunot_data</span> <span class="op">&lt;-</span> <span class="fu">separate</span><span class="op">(</span><span class="va">immunot_data</span>, <span class="st">"Label"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group"</span>, <span class="cn">NA</span>, <span class="st">"Subject"</span>, <span class="cn">NA</span>, <span class="st">"Plane"</span>, <span class="st">"Side"</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="st">"_"</span><span class="op">)</span>

<span class="va">values_by_group</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">immunot_data</span><span class="op">$</span><span class="va">Plane</span>, FUN <span class="op">=</span> <span class="va">length</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Plane <span class="op">=</span> <span class="va">immunot_data</span><span class="op">$</span><span class="va">Plane</span>, Group <span class="op">=</span> <span class="va">immunot_data</span><span class="op">$</span><span class="va">Group</span>, <span class="va">immunot_data</span><span class="op">$</span><span class="va">Subject</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">values_by_group_avg_by_plane</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">values_by_group</span><span class="op">$</span><span class="va">x</span>, FUN <span class="op">=</span> <span class="va">mean</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Group <span class="op">=</span> <span class="va">values_by_group</span><span class="op">$</span><span class="va">Group</span>, Subject <span class="op">=</span> <span class="va">values_by_group</span><span class="op">$</span><span class="va">Group.3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre>
<p>gp1_values &lt;- as.vector(values_by_group_avg_by_plane<span class="math inline">\(x[values_by_group_avg_by_plane\)</span>Group == “Ctrl”]) gp2_values &lt;- as.vector(values_by_group_avg_by_plane<span class="math inline">\(x[values_by_group_avg_by_plane\)</span>Group == “Switch”])</p>
<pre><code><span class="va">gp1_grand_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">values_by_group_avg_by_plane</span><span class="op">[</span><span class="va">values_by_group_avg_by_plane</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">'Ctrl'</span>, <span class="st">'x'</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span> 
  <span class="va">gp2_grand_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">values_by_group_avg_by_plane</span><span class="op">[</span><span class="va">values_by_group_avg_by_plane</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">'Switch'</span>, <span class="st">'x'</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span>
  
  <span class="va">gp1_sterr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">gp1_values</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span> 
  <span class="va">gp2_sterr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">gp2_values</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>
  
  <span class="va">cross_plane_sds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gp1_sterr</span>, <span class="va">gp2_sterr</span><span class="op">)</span>

<span class="va">cross_plane_compare</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gp1_grand_mean</span>, <span class="va">gp2_grand_mean</span><span class="op">)</span><span class="op">)</span>

<span class="va">graph_df_without_plane</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ctrl"</span>, <span class="st">"Switch"</span><span class="op">)</span>,
                                Cells_Counted <span class="op">=</span> <span class="va">cross_plane_compare</span><span class="op">)</span>
                                
<span class="fu">ggplot</span><span class="op">(</span><span class="va">graph_df_without_plane</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Group</span>, y <span class="op">=</span> <span class="va">Cells_Counted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="op">(</span><span class="va">Cells_Counted</span> <span class="op">-</span> <span class="va">cross_plane_sds</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="op">(</span><span class="va">Cells_Counted</span> <span class="op">+</span> <span class="va">cross_plane_sds</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre>
<p>overall_t &lt;- t.test(gp1_values, gp2_values, var.equal = TRUE) overall_t</p>
<p>}</p>
</div>
<div class="section level3">
<h3 id="for-cell-count-analyses-split-across-planes">For cell count analyses, split across planes<a class="anchor" aria-label="anchor" href="#for-cell-count-analyses-split-across-planes"></a>
</h3>
<p>immunot_percent &lt;- function(type, measure, region, first_group, data){</p>
<p>library(stringr) library(dplyr) library(tidyr) library(ggplot2) library(patchwork)</p>
<pre><code><span class="va">immunot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"outline_VTA.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span>, dec <span class="op">=</span> <span class="st">"."</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Label"</span>, <span class="st">"Mean"</span>, <span class="st">"X.Area"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">immunot_data</span> <span class="op">&lt;-</span> <span class="fu">separate</span><span class="op">(</span><span class="va">immunot_data</span>, <span class="st">"Label"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group"</span>, <span class="cn">NA</span>, <span class="st">"Subject"</span>, <span class="cn">NA</span>, <span class="st">"Plane"</span>, <span class="st">"Side"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="st">"_"</span><span class="op">)</span></code></pre>
<p>counts_by_plane &lt;- tibble(aggregate(immunot_data<span class="math inline">\(Plane, FUN = length, by = list(Plane = immunot_data\)</span>Plane, Group = immunot_data<span class="math inline">\(Group, immunot_data\)</span>Subject)))</p>
<p>gp1_ant &lt;- counts_by_plane[counts_by_plane<span class="math inline">\(Group == "Ctrl" &amp; counts_by_plane\)</span>Plane == “Ant”, ] gp1_ant_values &lt;- as.vector(t(gp1_ant %&gt;% select(x))) gp2_ant &lt;- counts_by_plane[counts_by_plane<span class="math inline">\(Group == "Switch" &amp; counts_by_plane\)</span>Plane == “Ant”, ] gp2_ant_values &lt;- as.vector(t(gp2_ant %&gt;% select(x)))</p>
<p>gp1_med &lt;- counts_by_plane[counts_by_plane<span class="math inline">\(Group == "Ctrl" &amp; counts_by_plane\)</span>Plane == “Med”, ] gp1_med_values &lt;- as.vector(t(gp1_med %&gt;% select(x))) gp2_med &lt;- counts_by_plane[counts_by_plane<span class="math inline">\(Group == "Switch" &amp; counts_by_plane\)</span>Plane == “Med”, ] gp2_med_values &lt;- as.vector(t(gp2_med %&gt;% select(x)))</p>
<p>gp1_pos &lt;- counts_by_plane[counts_by_plane<span class="math inline">\(Group == "Ctrl" &amp; counts_by_plane\)</span>Plane == “Pos”, ] gp1_pos_values &lt;- as.vector(t(gp1_pos %&gt;% select(x))) gp2_pos &lt;- counts_by_plane[counts_by_plane<span class="math inline">\(Group == "Switch" &amp; counts_by_plane\)</span>Plane == “Pos”, ] gp2_pos_values &lt;- as.vector(t(gp2_pos %&gt;% select(x)))</p>
<p>plane_count_aov &lt;- tibble(Group = rep(rep(c(“gp1”, “gp2”), each = 6), 3), Plane = rep(c(“ant”, “med”, “pos”), each = 12), Counts = c(gp1_ant_values, gp2_ant_values, gp1_med_values, gp2_med_values, gp1_pos_values, gp2_pos_values) )</p>
<p>means_by_plane &lt;- aggregate(counts_by_plane<span class="math inline">\(x, FUN = mean, by = list(Plane = counts_by_plane\)</span>Plane, Group = counts_by_plane$Group))</p>
<p>sds_by_plane &lt;- tibble(aggregate(counts_by_plane<span class="math inline">\(x, FUN = sd, by = list(Plane = counts_by_plane\)</span>Plane, Group = counts_by_plane$Group)))</p>
<pre><code><span class="va">gp1_mean_ant</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span>
<span class="va">gp1_mean_med</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span>
<span class="va">gp1_mean_pos</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">]</span>
<span class="va">gp2_mean_ant</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">3</span><span class="op">]</span>
<span class="va">gp2_mean_med</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">3</span><span class="op">]</span>
<span class="va">gp2_mean_pos</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">6</span>,<span class="fl">3</span><span class="op">]</span>

<span class="va">gp1_sterr_ant</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gp1_ant_values</span><span class="op">)</span><span class="op">)</span>
<span class="va">gp1_sterr_med</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gp1_med_values</span><span class="op">)</span><span class="op">)</span>
<span class="va">gp1_sterr_pos</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gp1_pos_values</span><span class="op">)</span><span class="op">)</span>
<span class="va">gp2_sterr_ant</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gp2_ant_values</span><span class="op">)</span><span class="op">)</span>
<span class="va">gp2_sterr_med</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gp2_med_values</span><span class="op">)</span><span class="op">)</span>
<span class="va">gp2_sterr_pos</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">6</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gp2_pos_values</span><span class="op">)</span><span class="op">)</span></code></pre>
<p>ant_compare &lt;- as.numeric(c(gp1_mean_ant, gp2_mean_ant))</p>
<p>med_compare &lt;- as.numeric(c(gp1_mean_med, gp2_mean_med))</p>
<p>pos_compare &lt;- as.numeric(c(gp1_mean_pos, gp2_mean_pos))</p>
<p>ant_sterrs &lt;- as.numeric(c(gp1_sterr_ant, gp2_sterr_ant))</p>
<p>med_sterrs &lt;- as.numeric(c(gp1_sterr_med, gp2_sterr_med))</p>
<p>pos_sterrs &lt;- as.numeric(c(gp1_sterr_pos, gp2_sterr_pos))</p>
<p>graph_df_ant &lt;- tibble(Ant = rep(c(“Ctrl”, “Switch”)), Cells_Counted = ant_compare)</p>
<p>graph_df_med &lt;- tibble(Med = rep(c(“Ctrl”, “Switch”)), Cells_Counted = med_compare)</p>
<p>graph_df_pos &lt;- tibble(Pos = rep(c(“Ctrl”, “Switch”)), Cells_Counted = pos_compare)</p>
<pre><code><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">graph_df_ant</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Ant</span>, y <span class="op">=</span> <span class="va">Cells_Counted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="op">(</span><span class="va">Cells_Counted</span> <span class="op">-</span> <span class="va">ant_sterrs</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="op">(</span><span class="va">Cells_Counted</span> <span class="op">+</span> <span class="va">ant_sterrs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">graph_df_med</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Med</span>, y <span class="op">=</span> <span class="va">Cells_Counted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="op">(</span><span class="va">Cells_Counted</span> <span class="op">-</span> <span class="va">med_sterrs</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="op">(</span><span class="va">Cells_Counted</span> <span class="op">+</span> <span class="va">med_sterrs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">graph_df_pos</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Pos</span>, y <span class="op">=</span> <span class="va">Cells_Counted</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="op">(</span><span class="va">Cells_Counted</span> <span class="op">-</span> <span class="va">pos_sterrs</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="op">(</span><span class="va">Cells_Counted</span> <span class="op">+</span> <span class="va">pos_sterrs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">a</span><span class="op">+</span><span class="va">m</span><span class="op">+</span><span class="va">p</span></code></pre>
<p>plane_wise_anova &lt;- summary(aov(Counts ~ Plane*Group, data = plane_count_aov)) plane_wise_anova</p>
<p>}</p>
</div>
<div class="section level3">
<h3 id="for-intensity-analyses-combined-across-planes">For intensity analyses, combined across planes<a class="anchor" aria-label="anchor" href="#for-intensity-analyses-combined-across-planes"></a>
</h3>
<p>immunot_percent &lt;- function(type, measure, region, first_group, n_per_group, data){</p>
<pre><code><span class="va">immunot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"outline_VTA.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span>, dec <span class="op">=</span> <span class="st">"."</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Label"</span>, <span class="st">"Mean"</span>, <span class="st">"X.Area"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">immunot_data</span> <span class="op">&lt;-</span> <span class="fu">separate</span><span class="op">(</span><span class="va">immunot_data</span>, <span class="st">"Label"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group"</span>, <span class="cn">NA</span>, <span class="st">"Subject"</span>, <span class="cn">NA</span>, <span class="st">"Plane"</span>, <span class="st">"Side"</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="st">"_"</span><span class="op">)</span>

  <span class="va">gp1_grand_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">immunot_data</span><span class="op">[</span><span class="va">immunot_data</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">'Ctrl'</span>, <span class="st">'Mean'</span><span class="op">]</span><span class="op">)</span>
  <span class="va">gp2_grand_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">immunot_data</span><span class="op">[</span><span class="va">immunot_data</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">'Switch'</span>, <span class="st">'Mean'</span><span class="op">]</span><span class="op">)</span>
  
  <span class="va">gp1_grand_sterr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">immunot_data</span><span class="op">[</span><span class="va">immunot_data</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">'Ctrl'</span>, <span class="st">'Mean'</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">immunot_data</span><span class="op">[</span><span class="va">immunot_data</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">'Ctrl'</span>, <span class="st">'Mean'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
  <span class="va">gp2_grand_sterr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">immunot_data</span><span class="op">[</span><span class="va">immunot_data</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">'Switch'</span>, <span class="st">'Mean'</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">immunot_data</span><span class="op">[</span><span class="va">immunot_data</span><span class="op">$</span><span class="va">Group</span> <span class="op">==</span> <span class="st">'Switch'</span>, <span class="st">'Mean'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
  
  <span class="va">cross_plane_sterr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gp1_grand_sterr</span>, <span class="va">gp2_grand_sterr</span><span class="op">)</span>

<span class="va">cross_plane_compare</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gp1_grand_mean</span>, <span class="va">gp2_grand_mean</span><span class="op">)</span><span class="op">)</span>

<span class="va">graph_df_without_plane</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ctrl"</span>, <span class="st">"Switch"</span><span class="op">)</span>,
                                Intensity <span class="op">=</span> <span class="va">cross_plane_compare</span><span class="op">)</span>
                                
<span class="fu">ggplot</span><span class="op">(</span><span class="va">graph_df_without_plane</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Group</span>, y <span class="op">=</span> <span class="va">Intensity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="op">(</span><span class="va">Intensity</span> <span class="op">-</span> <span class="va">cross_plane_sterr</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="op">(</span><span class="va">Intensity</span> <span class="op">+</span> <span class="va">cross_plane_sterr</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre>
<p>values_by_group &lt;- tibble(aggregate(immunot_data<span class="math inline">\(Mean, FUN = mean, by = list(Group = immunot_data\)</span>Group, Subject = immunot_data$Subject)))</p>
<p>values_by_group_avg_by_plane &lt;- tibble(aggregate(values_by_group<span class="math inline">\(x, FUN = mean, by = list(Group = values_by_group\)</span>Group, Subject = values_by_group$Group.3)))</p>
<p>gp1_values &lt;- as.vector(values_by_group<span class="math inline">\(x[values_by_group\)</span>Group == “Ctrl”]) gp2_values &lt;- as.vector(values_by_group<span class="math inline">\(x[values_by_group\)</span>Group == “Switch”])</p>
<p>overall_t &lt;- t.test(gp1_values, gp2_values, var.equal = TRUE) overall_t</p>
<p>}</p>
</div>
<div class="section level3">
<h3 id="for-intensity-analyses-split-across-planes">For intensity analyses, split across planes<a class="anchor" aria-label="anchor" href="#for-intensity-analyses-split-across-planes"></a>
</h3>
<p>immunot_percent &lt;- function(type, measure, region, first_group, data){</p>
<pre><code><span class="va">immunot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"percent_ps6_BLA.csv"</span>, header <span class="op">=</span> <span class="cn">TRUE</span>, sep <span class="op">=</span> <span class="st">","</span>, dec <span class="op">=</span> <span class="st">"."</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Label"</span>, <span class="st">"Mean"</span>, <span class="st">"X.Area"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">immunot_data</span> <span class="op">&lt;-</span> <span class="fu">separate</span><span class="op">(</span><span class="va">immunot_data</span>, <span class="st">"Label"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group"</span>, <span class="cn">NA</span>, <span class="st">"Subject"</span>, <span class="cn">NA</span>, <span class="st">"Plane"</span>, <span class="st">"Side"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="st">"_"</span><span class="op">)</span></code></pre>
<p>means_by_plane &lt;- tibble(aggregate(immunot_data<span class="math inline">\(Mean, FUN = mean, by = list(Plane = immunot_data\)</span>Plane, Group = immunot_data$Group)))</p>
<p>sds_by_plane &lt;- tibble(aggregate(immunot_data<span class="math inline">\(Mean, FUN = sd, by = list(Plane = immunot_data\)</span>Plane, Group = immunot_data$Group)))</p>
<pre><code><span class="va">gp1_mean_ant</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span>
<span class="va">gp1_mean_med</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span>
<span class="va">gp1_mean_pos</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">]</span>
<span class="va">gp2_mean_ant</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">3</span><span class="op">]</span>
<span class="va">gp2_mean_med</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">3</span><span class="op">]</span>
<span class="va">gp2_mean_pos</span> <span class="op">&lt;-</span> <span class="va">means_by_plane</span><span class="op">[</span><span class="fl">6</span>,<span class="fl">3</span><span class="op">]</span>

<span class="va">gp1_sterr_ant</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>
<span class="va">gp1_sterr_med</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>
<span class="va">gp1_sterr_pos</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>
<span class="va">gp2_sterr_ant</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">4</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>
<span class="va">gp2_sterr_med</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">5</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>
<span class="va">gp2_sterr_pos</span> <span class="op">&lt;-</span> <span class="va">sds_by_plane</span><span class="op">[</span><span class="fl">6</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span></code></pre>
<p>ant_compare &lt;- as.numeric(c(gp1_mean_ant, gp2_mean_ant))</p>
<p>med_compare &lt;- as.numeric(c(gp1_mean_med, gp2_mean_med))</p>
<p>pos_compare &lt;- as.numeric(c(gp1_mean_pos, gp2_mean_pos))</p>
<p>ant_sterrs &lt;- as.numeric(c(gp1_sterr_ant, gp2_sterr_ant))</p>
<p>med_sterrs &lt;- as.numeric(c(gp1_sterr_med, gp2_sterr_med))</p>
<p>pos_sterrs &lt;- as.numeric(c(gp1_sterr_pos, gp2_sterr_pos))</p>
<p>graph_df_ant &lt;- tibble(Ant = rep(c(“Ctrl”, “Switch”)), Intensity = ant_compare)</p>
<p>graph_df_med &lt;- tibble(Med = rep(c(“Ctrl”, “Switch”)), Intensity = med_compare)</p>
<p>graph_df_pos &lt;- tibble(Pos = rep(c(“Ctrl”, “Switch”)), Intensity = pos_compare)</p>
<pre><code><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">graph_df_ant</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Ant</span>, y <span class="op">=</span> <span class="va">Intensity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="op">(</span><span class="va">Intensity</span> <span class="op">-</span> <span class="va">ant_sterrs</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="op">(</span><span class="va">Intensity</span> <span class="op">+</span> <span class="va">ant_sterrs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">graph_df_med</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Med</span>, y <span class="op">=</span> <span class="va">Intensity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="op">(</span><span class="va">Intensity</span> <span class="op">-</span> <span class="va">med_sterrs</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="op">(</span><span class="va">Intensity</span> <span class="op">+</span> <span class="va">med_sterrs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">graph_df_pos</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Pos</span>, y <span class="op">=</span> <span class="va">Intensity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="op">(</span><span class="va">Intensity</span> <span class="op">-</span> <span class="va">pos_sterrs</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="op">(</span><span class="va">Intensity</span> <span class="op">+</span> <span class="va">pos_sterrs</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">a</span><span class="op">+</span><span class="va">m</span><span class="op">+</span><span class="va">p</span></code></pre>
<p>plane_wise_anova &lt;- summary(aov(Mean ~ Plane*Group, data = immunot_data)) plane_wise_anova</p>
<p>}</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">DBSStats2Labs</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Dan Siegel.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
