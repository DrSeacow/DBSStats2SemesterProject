<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab9_RMAnova â€¢ DBSStats2SemesterProject</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab9_RMAnova">
<meta property="og:description" content="DBSStats2SemesterProject">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DBSStats2SemesterProject</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/About.html">About</a>
    </li>
    <li>
      <a href="../articles/Final_Lab_WYOR.html">Final_Lab_WYOR</a>
    </li>
    <li>
      <a href="../articles/Lab1.html">Lab1</a>
    </li>
    <li>
      <a href="../articles/Lab10_NestedDesigns.html">Lab10_NestedDesigns</a>
    </li>
    <li>
      <a href="../articles/Lab2.html">Lab2</a>
    </li>
    <li>
      <a href="../articles/Lab3.html">Lab3</a>
    </li>
    <li>
      <a href="../articles/Lab4_ANOVA.html">Lab4</a>
    </li>
    <li>
      <a href="../articles/Lab5a.html">Lab5a</a>
    </li>
    <li>
      <a href="../articles/Lab6_OrthNonOrthContrasts.html">Lab6</a>
    </li>
    <li>
      <a href="../articles/Lab7_FactorialAnova.html">Lab7_FactorialAnova</a>
    </li>
    <li>
      <a href="../articles/Lab8_FactorialAnova_Pt2_w_Contrasts.html">Lab8_FactorialAnova_Pt2_w_Contrasts</a>
    </li>
    <li>
      <a href="../articles/Lab9_RMAnova.html">Lab9_RMAnova</a>
    </li>
    <li>
      <a href="../articles/R_Basics_Practicals.html">R Basics</a>
    </li>
    <li>
      <a href="../articles/slide_deck.html">Intro to Immuno Analyze - IO Slide Deck</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab9_RMAnova</h1>
            
      
      
      <div class="hidden name"><code>Lab9_RMAnova.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="generalization-assignment">Generalization Assignment<a class="anchor" aria-label="anchor" href="#generalization-assignment"></a>
</h2>
<div class="section level3">
<h3 id="perhaps-unfortunately-this-whole-assignment-was-completed-with-the-help-of-the-solutions-video--everything-felt-intuitive-and-much-was-learned-from-this-assignment--however-there-were-numerous-moments-where-i-felt-clueless-on-what-specifically-to-do-or-what-format-to-use--i-watched-the-entire-video-closely-and-made-sure-i-understood-everything-in-retrospect--admittedly-in-terms-of-the-0-100-struggle-report-this-whole-assignment-was-likely-a-0-">Perhaps unfortunately, this whole assignment was completed with the help of the solutions video. Everything felt intuitive and much was learned from this assignment. However, there were numerous moments where I felt clueless on what specifically to do or what format to use. I watched the entire video closely and made sure I understood everything in retrospect. Admittedly, in terms of the 0-100% struggle-report, this whole assignment was likely a 0%.<a class="anchor" aria-label="anchor" href="#perhaps-unfortunately-this-whole-assignment-was-completed-with-the-help-of-the-solutions-video--everything-felt-intuitive-and-much-was-learned-from-this-assignment--however-there-were-numerous-moments-where-i-felt-clueless-on-what-specifically-to-do-or-what-format-to-use--i-watched-the-entire-video-closely-and-made-sure-i-understood-everything-in-retrospect--admittedly-in-terms-of-the-0-100-struggle-report-this-whole-assignment-was-likely-a-0-"></a>
</h3>
</div>
<div class="section level3">
<h3 id="create-an-r-script-that-can-generate-simulated-data-for-the-following-repeated-measures-design--2-points">1. Create an R script that can generate simulated data for the following repeated measures design. (2 points)<a class="anchor" aria-label="anchor" href="#create-an-r-script-that-can-generate-simulated-data-for-the-following-repeated-measures-design--2-points"></a>
</h3>
</div>
<div class="section level3">
<h3 id="a--the-dependent-variable-is-assumed-to-come-from-a-normal-distribution-with-mean-0-and-standard-deviation-1-">A. The dependent variable is assumed to come from a normal distribution with mean = 0 and standard deviation = 1.<a class="anchor" aria-label="anchor" href="#a--the-dependent-variable-is-assumed-to-come-from-a-normal-distribution-with-mean-0-and-standard-deviation-1-"></a>
</h3>
</div>
<div class="section level3">
<h3 id="b--there-is-one-repeated-measures-factor-with-5-levels-down1-down2-control-up1-up2--the-control-group-is-assumed-to-have-no-effect--the-down1-and-down2-levels-shift-the-mean-down-by-1-and-2-standard-deviations-respectively--the-up1-and-up2-levels-shift-the-mean-up-by-1-and-2-standard-deviations-respectively-">B. There is one repeated measures factor with 5 levels (Down1, Down2, Control, Up1, Up2). The control group is assumed to have no effect. The Down1 and Down2 levels shift the mean down by 1 and 2 standard deviations, respectively. The Up1 and Up2 levels shift the mean up by 1 and 2 standard deviations, respectively.<a class="anchor" aria-label="anchor" href="#b--there-is-one-repeated-measures-factor-with-5-levels-down1-down2-control-up1-up2--the-control-group-is-assumed-to-have-no-effect--the-down1-and-down2-levels-shift-the-mean-down-by-1-and-2-standard-deviations-respectively--the-up1-and-up2-levels-shift-the-mean-up-by-1-and-2-standard-deviations-respectively-"></a>
</h3>
</div>
<div class="section level3">
<h3 id="c--there-are-6-subjects-in-the-experiment-and-they-are-each-measured-once-in-each-condition--the-6-subjects-are-assumed-to-be-different-from-one-another-e-g--they-will-have-different-baseline-means-in-the-control-condition-but-they-will-all-be-influenced-by-the-iv-in-the-exact-same-way-e-g--no-interaction-">C. There are 6 subjects in the experiment, and they are each measured once in each condition. The 6 subjects are assumed to be different from one another (e.g., they will have different baseline means in the control condition), but they will all be influenced by the IV in the exact same way (e.g., no interaction).<a class="anchor" aria-label="anchor" href="#c--there-are-6-subjects-in-the-experiment-and-they-are-each-measured-once-in-each-condition--the-6-subjects-are-assumed-to-be-different-from-one-another-e-g--they-will-have-different-baseline-means-in-the-control-condition-but-they-will-all-be-influenced-by-the-iv-in-the-exact-same-way-e-g--no-interaction-"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; Warning: package 'dplyr' was built under R version 4.1.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span>
<span class="co">#&gt; Warning: package 'tibble' was built under R version 4.1.3</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.1.3</span>

<span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>
  subjects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,
  IV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Down2"</span>, <span class="st">"Down1"</span>, <span class="st">"Control"</span>, <span class="st">"Up1"</span>, <span class="st">"Up2"</span><span class="op">)</span>, <span class="fl">6</span><span class="op">)</span>,
  DV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">6</span><span class="op">*</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>
<span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>DV <span class="op">=</span> <span class="va">DV</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>

<span class="va">sim_data</span><span class="op">$</span><span class="va">IV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">IV</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Down2"</span>, <span class="st">"Down1"</span>, <span class="st">"Control"</span>, <span class="st">"Up1"</span>, <span class="st">"Up2"</span><span class="op">)</span><span class="op">)</span>

<span class="va">sim_data</span><span class="op">$</span><span class="va">subjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">subjects</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sim_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">IV</span>, y <span class="op">=</span> <span class="va">DV</span>, group <span class="op">=</span> <span class="va">subjects</span>,
                     color <span class="op">=</span> <span class="va">subjects</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="Lab9_RMAnova_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="run-a-simulation-to-determine-the-proportion-of-experiments-that-would-return-a-significant-result-for-the-above-design--assume-that-the-effect-of-the-levels-of-the-iv-are-increments-of--1-of-a-standard-deviation-rather-than-increments-of-1-as-in-the-above-design-">2. Run a simulation to determine the proportion of experiments that would return a significant result for the above design. Assume that the effect of the levels of the IV are increments of .1 of a standard deviation, rather than increments of 1 as in the above design.<a class="anchor" aria-label="anchor" href="#run-a-simulation-to-determine-the-proportion-of-experiments-that-would-return-a-significant-result-for-the-above-design--assume-that-the-effect-of-the-levels-of-the-iv-are-increments-of--1-of-a-standard-deviation-rather-than-increments-of-1-as-in-the-above-design-"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">save_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1000</span><span class="op">)</span><span class="op">{</span>

<span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>
  subjects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,
  IV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Down2"</span>, <span class="st">"Down1"</span>, <span class="st">"Control"</span>, <span class="st">"Up1"</span>, <span class="st">"Up2"</span><span class="op">)</span>, <span class="fl">6</span><span class="op">)</span>,
  DV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">6</span><span class="op">*</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>
<span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>DV <span class="op">=</span> <span class="va">DV</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>

<span class="va">sim_data</span><span class="op">$</span><span class="va">IV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">IV</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Down2"</span>, <span class="st">"Down1"</span>, <span class="st">"Control"</span>, <span class="st">"Up1"</span>, <span class="st">"Up2"</span><span class="op">)</span><span class="op">)</span>

<span class="va">sim_data</span><span class="op">$</span><span class="va">subjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">subjects</span><span class="op">)</span>

<span class="va">aov_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">DV</span> <span class="op">~</span> <span class="va">IV</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">Error</a></span><span class="op">(</span><span class="va">subjects</span><span class="op">)</span>, <span class="va">sim_data</span><span class="op">)</span><span class="op">)</span>
<span class="va">save_p</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">aov_out</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">$</span><span class="va">`Error: Within`</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">`Pr(&gt;F)`</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">save_p</span><span class="op">[</span><span class="va">save_p</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">1000</span>
<span class="co">#&gt; [1] 0.999</span>

<span class="co">### I'm not really sure what's going on here. I ended up frustratingly copying this *exactly* from your solutions video, and for some reason all of the P-Values are coming out as null values. </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="demonstrate-that-the-godden-and-baddeley-example-data-from-the-textbook-19-5-which-used-a-2x2-repeated-measures-design-can-be-be-analyzed-with-one-sample-t-tests-to-return-the-same-results--specifically-show-the-one-sample-t-tests-for-each-main-effect-and-the-interaction--2-points">3. Demonstrate that the Godden and Baddeley example data from the textbook (19.5), which used a 2x2 repeated measures design, can be be analyzed with one-sample t-tests to return the same results. Specifically, show the one-sample t-tests for each main effect and the interaction. (2 points)<a class="anchor" aria-label="anchor" href="#demonstrate-that-the-godden-and-baddeley-example-data-from-the-textbook-19-5-which-used-a-2x2-repeated-measures-design-can-be-be-analyzed-with-one-sample-t-tests-to-return-the-same-results--specifically-show-the-one-sample-t-tests-for-each-main-effect-and-the-interaction--2-points"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">godden_baddeley</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">Subjects</span>, <span class="op">~</span><span class="va">LearningPlace</span>, <span class="op">~</span><span class="va">TestingPlace</span>, <span class="op">~</span><span class="va">Recall</span>,
                           <span class="st">"s1"</span>, <span class="st">"On Land"</span>, <span class="st">"On Land"</span>, <span class="fl">34</span>,
                           <span class="st">"s2"</span>, <span class="st">"On Land"</span>, <span class="st">"On Land"</span>, <span class="fl">37</span>,
                           <span class="st">"s3"</span>, <span class="st">"On Land"</span>, <span class="st">"On Land"</span>, <span class="fl">27</span>,
                           <span class="st">"s4"</span>, <span class="st">"On Land"</span>, <span class="st">"On Land"</span>, <span class="fl">43</span>,
                           <span class="st">"s5"</span>, <span class="st">"On Land"</span>, <span class="st">"On Land"</span>, <span class="fl">44</span>,
                           <span class="st">"s1"</span>, <span class="st">"On Land"</span>, <span class="st">"Under Sea"</span>, <span class="fl">18</span>,
                           <span class="st">"s2"</span>, <span class="st">"On Land"</span>, <span class="st">"Under Sea"</span>, <span class="fl">21</span>,
                           <span class="st">"s3"</span>, <span class="st">"On Land"</span>, <span class="st">"Under Sea"</span>, <span class="fl">25</span>,
                           <span class="st">"s4"</span>, <span class="st">"On Land"</span>, <span class="st">"Under Sea"</span>, <span class="fl">37</span>,
                           <span class="st">"s5"</span>, <span class="st">"On Land"</span>, <span class="st">"Under Sea"</span>, <span class="fl">34</span>,
                           <span class="st">"s1"</span>, <span class="st">"Under Sea"</span>, <span class="st">"On Land"</span>, <span class="fl">14</span>,
                           <span class="st">"s2"</span>, <span class="st">"Under Sea"</span>, <span class="st">"On Land"</span>, <span class="fl">21</span>,
                           <span class="st">"s3"</span>, <span class="st">"Under Sea"</span>, <span class="st">"On Land"</span>, <span class="fl">31</span>,
                           <span class="st">"s4"</span>, <span class="st">"Under Sea"</span>, <span class="st">"On Land"</span>, <span class="fl">27</span>,
                           <span class="st">"s5"</span>, <span class="st">"Under Sea"</span>, <span class="st">"On Land"</span>, <span class="fl">32</span>,
                           <span class="st">"s1"</span>, <span class="st">"Under Sea"</span>, <span class="st">"Under Sea"</span>, <span class="fl">22</span>,
                           <span class="st">"s2"</span>, <span class="st">"Under Sea"</span>, <span class="st">"Under Sea"</span>, <span class="fl">25</span>,
                           <span class="st">"s3"</span>, <span class="st">"Under Sea"</span>, <span class="st">"Under Sea"</span>, <span class="fl">33</span>,
                           <span class="st">"s4"</span>, <span class="st">"Under Sea"</span>, <span class="st">"Under Sea"</span>, <span class="fl">33</span>,
                           <span class="st">"s5"</span>, <span class="st">"Under Sea"</span>, <span class="st">"Under Sea"</span>, <span class="fl">42</span>
<span class="op">)</span>

<span class="va">godden_baddeley</span> <span class="op">&lt;-</span> <span class="va">godden_baddeley</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Subjects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Subjects</span><span class="op">)</span>,
         LearningPlace <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">LearningPlace</span><span class="op">)</span>,
         TestingPlace <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">TestingPlace</span><span class="op">)</span><span class="op">)</span>

<span class="va">aov_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">Recall</span> <span class="op">~</span> <span class="va">LearningPlace</span> <span class="op">*</span> <span class="va">TestingPlace</span> <span class="op">+</span>
                 <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">Error</a></span><span class="op">(</span><span class="va">Subjects</span><span class="op">/</span><span class="op">(</span><span class="va">LearningPlace</span><span class="op">*</span><span class="va">TestingPlace</span><span class="op">)</span><span class="op">)</span>, <span class="va">godden_baddeley</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aov_out</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: Subjects</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; Residuals  4    680     170               </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: Subjects:LearningPlace</span>
<span class="co">#&gt;               Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; LearningPlace  1     80      80       2   0.23</span>
<span class="co">#&gt; Residuals      4    160      40               </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: Subjects:TestingPlace</span>
<span class="co">#&gt;              Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; TestingPlace  1     20      20     2.5  0.189</span>
<span class="co">#&gt; Residuals     4     32       8               </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: Subjects:LearningPlace:TestingPlace</span>
<span class="co">#&gt;                            Df Sum Sq Mean Sq F value Pr(&gt;F)  </span>
<span class="co">#&gt; LearningPlace:TestingPlace  1    320     320      20 0.0111 *</span>
<span class="co">#&gt; Residuals                   4     64      16                 </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">godden_baddeley</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TestingPlace</span>,
                            y <span class="op">=</span> <span class="va">Recall</span>,
                            shape <span class="op">=</span> <span class="va">LearningPlace</span>,
                            group <span class="op">=</span> <span class="va">LearningPlace</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"summary"</span>, fun <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"summary"</span>, fun <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></code></pre></div>
<p><img src="Lab9_RMAnova_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="q3-but-how-would-we-do-this-using-one-sample-t-tests">Q3: But how would we do this using one-sample t-tests?<a class="anchor" aria-label="anchor" href="#q3-but-how-would-we-do-this-using-one-sample-t-tests"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">### For the main effect of learning place:</span>

<span class="va">learning_place_means</span> <span class="op">&lt;-</span> <span class="va">godden_baddeley</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Subjects</span>, <span class="va">LearningPlace</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>mean_recall <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Recall</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'Subjects'. You can override using the</span>
<span class="co">#&gt; `.groups` argument.</span>

<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">mean_recall</span> <span class="op">~</span> <span class="va">LearningPlace</span>, paired <span class="op">=</span> <span class="cn">TRUE</span>, data <span class="op">=</span> <span class="va">learning_place_means</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Paired t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  mean_recall by LearningPlace</span>
<span class="co">#&gt; t = 1.4142, df = 4, p-value = 0.2302</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -3.852973 11.852973</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of the differences </span>
<span class="co">#&gt;                       4</span>

<span class="va">Learning_land</span> <span class="op">&lt;-</span> <span class="va">learning_place_means</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">LearningPlace</span> <span class="op">==</span> <span class="st">"On Land"</span><span class="op">)</span> 

<span class="va">Learning_sea</span> <span class="op">&lt;-</span> <span class="va">learning_place_means</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">LearningPlace</span> <span class="op">==</span> <span class="st">"Under Sea"</span><span class="op">)</span> 

<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">Learning_land</span><span class="op">$</span><span class="va">mean_recall</span> <span class="op">-</span> <span class="va">Learning_sea</span><span class="op">$</span><span class="va">mean_recall</span>, mu <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  One Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  Learning_land$mean_recall - Learning_sea$mean_recall</span>
<span class="co">#&gt; t = 1.4142, df = 4, p-value = 0.2302</span>
<span class="co">#&gt; alternative hypothesis: true mean is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -3.852973 11.852973</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of x </span>
<span class="co">#&gt;         4</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">### For the main effect of testing place:</span>

<span class="va">testing_place_means</span> <span class="op">&lt;-</span> <span class="va">godden_baddeley</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Subjects</span>, <span class="va">TestingPlace</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>mean_recall <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Recall</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` has grouped output by 'Subjects'. You can override using the</span>
<span class="co">#&gt; `.groups` argument.</span>

<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">mean_recall</span> <span class="op">~</span> <span class="va">TestingPlace</span>, paired <span class="op">=</span> <span class="cn">TRUE</span>, data <span class="op">=</span> <span class="va">testing_place_means</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Paired t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  mean_recall by TestingPlace</span>
<span class="co">#&gt; t = 1.5811, df = 4, p-value = 0.189</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -1.511956  5.511956</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of the differences </span>
<span class="co">#&gt;                       2</span>

<span class="va">Testing_land</span> <span class="op">&lt;-</span> <span class="va">testing_place_means</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">TestingPlace</span> <span class="op">==</span> <span class="st">"On Land"</span><span class="op">)</span> 

<span class="va">Testing_sea</span> <span class="op">&lt;-</span> <span class="va">testing_place_means</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">TestingPlace</span> <span class="op">==</span> <span class="st">"Under Sea"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">Testing_land</span><span class="op">$</span><span class="va">mean_recall</span> <span class="op">-</span> <span class="va">Testing_sea</span><span class="op">$</span><span class="va">mean_recall</span>, mu <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  One Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  Testing_land$mean_recall - Testing_sea$mean_recall</span>
<span class="co">#&gt; t = 1.5811, df = 4, p-value = 0.189</span>
<span class="co">#&gt; alternative hypothesis: true mean is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -1.511956  5.511956</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of x </span>
<span class="co">#&gt;         2</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">### For the interaction effect:</span>

<span class="va">LL</span> <span class="op">&lt;-</span> <span class="va">godden_baddeley</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">LearningPlace</span> <span class="op">==</span> <span class="st">"On Land"</span>,
         <span class="va">TestingPlace</span> <span class="op">==</span> <span class="st">"On Land"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">Recall</span><span class="op">)</span>

<span class="va">LS</span> <span class="op">&lt;-</span> <span class="va">godden_baddeley</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">LearningPlace</span> <span class="op">==</span> <span class="st">"On Land"</span>,
         <span class="va">TestingPlace</span> <span class="op">==</span> <span class="st">"Under Sea"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">Recall</span><span class="op">)</span>

<span class="op">(</span><span class="va">LL</span> <span class="op">-</span> <span class="va">LS</span><span class="op">)</span>
<span class="co">#&gt; [1] 16 16  2  6 10</span>

<span class="va">SL</span> <span class="op">&lt;-</span> <span class="va">godden_baddeley</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">LearningPlace</span> <span class="op">==</span> <span class="st">"Under Sea"</span>,
         <span class="va">TestingPlace</span> <span class="op">==</span> <span class="st">"On Land"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">Recall</span><span class="op">)</span>

<span class="va">SS</span> <span class="op">&lt;-</span> <span class="va">godden_baddeley</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">LearningPlace</span> <span class="op">==</span> <span class="st">"Under Sea"</span>,
         <span class="va">TestingPlace</span> <span class="op">==</span> <span class="st">"Under Sea"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">Recall</span><span class="op">)</span>

<span class="op">(</span><span class="va">SL</span> <span class="op">-</span> <span class="va">SS</span><span class="op">)</span>
<span class="co">#&gt; [1]  -8  -4  -2  -6 -10</span>

<span class="op">(</span><span class="op">(</span><span class="va">LL</span> <span class="op">-</span> <span class="va">LS</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">SL</span> <span class="op">-</span> <span class="va">SS</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 24 20  4 12 20</span>

<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="op">(</span><span class="va">LL</span> <span class="op">-</span> <span class="va">LS</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">SL</span> <span class="op">-</span> <span class="va">SS</span><span class="op">)</span>, mu <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  One Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  (LL - LS) - (SL - SS)</span>
<span class="co">#&gt; t = 4.4721, df = 4, p-value = 0.01106</span>
<span class="co">#&gt; alternative hypothesis: true mean is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;   6.066688 25.933312</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of x </span>
<span class="co">#&gt;        16</span>

<span class="co">### I would've never thought this would be a way of running a one-sample T-Test on the interaction effect if it weren't for the solutions video...</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="bonus-points">Bonus Points<a class="anchor" aria-label="anchor" href="#bonus-points"></a>
</h2>
<div class="section level3">
<h3 id="these-bonus-questions-are-about-the-sphericity-concept-and-they-will-involve-modifying-the-example-data-from-the-textbook-same-as-used-in-concept-section-1-">These bonus questions are about the sphericity concept, and they will involve modifying the example data from the textbook (same as used in concept section 1).<a class="anchor" aria-label="anchor" href="#these-bonus-questions-are-about-the-sphericity-concept-and-they-will-involve-modifying-the-example-data-from-the-textbook-same-as-used-in-concept-section-1-"></a>
</h3>
</div>
<div class="section level3">
<h3 id="create-a-line-plot-showing-how-each-of-the-5-subjects-perform-across-the-levels-of-the-iv--discuss-how-the-line-plot-visually-shows-the-sphericity-problem-in-the-data-1-point">1. Create a line plot showing how each of the 5 subjects perform across the levels of the IV. Discuss how the line plot visually shows the sphericity problem in the data (1 point)<a class="anchor" aria-label="anchor" href="#create-a-line-plot-showing-how-each-of-the-5-subjects-perform-across-the-levels-of-the-iv--discuss-how-the-line-plot-visually-shows-the-sphericity-problem-in-the-data-1-point"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sphericity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">S</span>, <span class="op">~</span><span class="va">a1</span>, <span class="op">~</span><span class="va">a2</span>, <span class="op">~</span><span class="va">a3</span>, <span class="op">~</span><span class="va">a4</span>,
        <span class="st">"s1"</span>,<span class="fl">76</span>,<span class="fl">64</span>,<span class="fl">34</span>,<span class="fl">26</span>,
        <span class="st">"s2"</span>,<span class="fl">60</span>,<span class="fl">48</span>,<span class="fl">46</span>,<span class="fl">30</span>,
        <span class="st">"s3"</span>,<span class="fl">58</span>,<span class="fl">34</span>,<span class="fl">32</span>,<span class="fl">28</span>,
        <span class="st">"s4"</span>,<span class="fl">46</span>,<span class="fl">46</span>,<span class="fl">32</span>,<span class="fl">28</span>,
        <span class="st">"s5"</span>,<span class="fl">30</span>,<span class="fl">18</span>,<span class="fl">36</span>,<span class="fl">28</span>
        <span class="op">)</span> 

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="va">sphericity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">sphericity</span>,
                           cols <span class="op">=</span> <span class="op">!</span><span class="va">S</span>,
                           names_to <span class="op">=</span> <span class="st">"IV"</span>, 
                           values_to <span class="op">=</span> <span class="st">"DV"</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sphericity</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">IV</span>, y <span class="op">=</span> <span class="va">DV</span>, color <span class="op">=</span> <span class="va">S</span>, group <span class="op">=</span> <span class="va">S</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="Lab9_RMAnova_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">### It is evident that there is a sphericity issue based on this ggplot, as the covariance across the levels of the independent variable are clearly different across the subjects. Based on the appearance of the plot, it would seem evident that there could be a main effect of "subject" as well as a clear interaction effect between subject and the independent variable. This clearly risks to obfuscate the meaning of the IV effects and yields a confound with the subject factor.</span>

<span class="co">### Struggle-report: I needed the solution video's help for converting the data format into one subject to ggplot using tidyr, but I did not need the video to make the aforementioned conceptual interpretation once plotting the data.</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="modify-the-above-data-to-remove-the-sphericity-problem--specifically-ensure-that-all-subjects-are-different-from-another-there-overall-means-are-different-and-that-the-iv-has-the-same-effect-for-each-level-and-each-subject-no-interaction--then-plot-the-new-data-and-discuss-how-the-graph-shows-the-sphericity-problem-has-been-removed--1-point">2. Modify the above data to remove the sphericity problem. Specifically, ensure that all subjects are different from another (there overall means are different), and that the IV has the same effect for each level and each subject (no interaction). Then, plot the new data and discuss how the graph shows the sphericity problem has been removed. (1 point)<a class="anchor" aria-label="anchor" href="#modify-the-above-data-to-remove-the-sphericity-problem--specifically-ensure-that-all-subjects-are-different-from-another-there-overall-means-are-different-and-that-the-iv-has-the-same-effect-for-each-level-and-each-subject-no-interaction--then-plot-the-new-data-and-discuss-how-the-graph-shows-the-sphericity-problem-has-been-removed--1-point"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">sphericityFixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">S</span>, <span class="op">~</span><span class="va">a1</span>, <span class="op">~</span><span class="va">a2</span>, <span class="op">~</span><span class="va">a3</span>, <span class="op">~</span><span class="va">a4</span>,
        <span class="st">"s1"</span>,<span class="fl">76</span>,<span class="fl">64</span>,<span class="fl">34</span>,<span class="fl">26</span>,
        <span class="st">"s2"</span>,<span class="fl">60</span>,<span class="fl">48</span>,<span class="fl">18</span>,<span class="fl">10</span>,
        <span class="st">"s3"</span>,<span class="fl">58</span>,<span class="fl">46</span>,<span class="fl">16</span>,<span class="fl">8</span>,
        <span class="st">"s4"</span>,<span class="fl">46</span>,<span class="fl">34</span>,<span class="fl">4</span>,<span class="op">-</span><span class="fl">4</span>,
        <span class="st">"s5"</span>,<span class="fl">30</span>,<span class="fl">18</span>,<span class="op">-</span><span class="fl">12</span>,<span class="op">-</span><span class="fl">20</span>
        <span class="op">)</span> 

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="va">sphericityFixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">sphericityFixed</span>,
                           cols <span class="op">=</span> <span class="op">!</span><span class="va">S</span>,
                           names_to <span class="op">=</span> <span class="st">"IV"</span>, 
                           values_to <span class="op">=</span> <span class="st">"DV"</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sphericityFixed</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">IV</span>, y <span class="op">=</span> <span class="va">DV</span>, color <span class="op">=</span> <span class="va">S</span>, group <span class="op">=</span> <span class="va">S</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="Lab9_RMAnova_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">### Struggle-report: I seriously tried to figure this one out on my own, and thought I was onto something but ended up making it go way deeper (and more confusing) than I intended. Checking the solutions video, I really did not expect you to just be changing the raw data values themselves!! I assumed that this would involve some kind of transformation. </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculate-the-greenhouse-geisser-estimate-of-epsilon-for-your-modified-data-to-demonstrate-you-have-removed-the-sphericity-problem--1-point">3. Calculate the Greenhouse-Geisser estimate of epsilon for your modified data to demonstrate you have removed the sphericity problem. (1 point)<a class="anchor" aria-label="anchor" href="#calculate-the-greenhouse-geisser-estimate-of-epsilon-for-your-modified-data-to-demonstrate-you-have-removed-the-sphericity-problem--1-point"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sphericityFixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">S</span>, <span class="op">~</span><span class="va">a1</span>, <span class="op">~</span><span class="va">a2</span>, <span class="op">~</span><span class="va">a3</span>, <span class="op">~</span><span class="va">a4</span>,
        <span class="st">"s1"</span>,<span class="fl">76</span>,<span class="fl">64</span>,<span class="fl">34</span>,<span class="fl">26</span>,
        <span class="st">"s2"</span>,<span class="fl">60</span>,<span class="fl">48</span>,<span class="fl">18</span>,<span class="fl">10</span>,
        <span class="st">"s3"</span>,<span class="fl">58</span>,<span class="fl">46</span>,<span class="fl">16</span>,<span class="fl">8</span>,
        <span class="st">"s4"</span>,<span class="fl">46</span>,<span class="fl">34</span>,<span class="fl">4</span>,<span class="op">-</span><span class="fl">4</span>,
        <span class="st">"s5"</span>,<span class="fl">30</span>,<span class="fl">18</span>,<span class="op">-</span><span class="fl">12</span>,<span class="op">-</span><span class="fl">20</span>
        <span class="op">)</span> 

<span class="va">sphericityFixed</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 x 4</span></span>
<span class="co">#&gt;      a1    a2    a3    a4</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    76    64    34    26</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    60    48    18    10</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    58    46    16     8</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>    46    34     4    -<span style="color: #BB0000;">4</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>    30    18   -<span style="color: #BB0000;">12</span>   -<span style="color: #BB0000;">20</span></span>
<span class="va">cov_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">sphericityFixed</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>
<span class="va">col_mean_matrix</span> <span class="op">&lt;-</span> <span class="va">cov_matrix</span><span class="op">*</span><span class="fl">0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">cov_matrix</span><span class="op">)</span>
<span class="va">row_mean_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">cov_matrix</span><span class="op">*</span><span class="fl">0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">cov_matrix</span><span class="op">)</span><span class="op">)</span>
<span class="va">dc_matrix</span> <span class="op">&lt;-</span> <span class="va">cov_matrix</span> <span class="op">-</span> <span class="va">col_mean_matrix</span> <span class="op">-</span> <span class="va">row_mean_matrix</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">cov_matrix</span><span class="op">)</span>

<span class="co">### Greenhaus-Geisser correction time:</span>

<span class="co">### sum(diag(dc_matrix))^2 / ((dim(dc_matrix)[1]-1)*sum(dc_matrix^2))</span>

<span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">sphericityFixed</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;    a1 a2 a3 a4</span>
<span class="co">#&gt; a1  1  1  1  1</span>
<span class="co">#&gt; a2  1  1  1  1</span>
<span class="co">#&gt; a3  1  1  1  1</span>
<span class="co">#&gt; a4  1  1  1  1</span>

<span class="co">### Perfectly correlated covariances. The sphericity problem is apparently fixed.</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="it-was-only-after-consulting-the-solutions-video-for-a-later-question-that-i-realized-that-the-method-depicted-below-which-was-gone-over-in-class-is-pretty-different-from-that-in-the-video-to-the-extent-that-i-got-a-bit-bewildered-and-confused--while-all-of-this-intuitively-makes-sense-to-me-and-im-learning-along-with-it-there-are-many-points-here-where-id-feel-completely-lost-and-confused-if-not-for-the-solutions-video--therefore-im-afraid-ill-have-to-just-consider-myself-a-0-on-the-struggle-report-for-this-whole-assignment--but-the-procedures-that-we-went-over-in-class-remain-below-">It was only after consulting the solutions video for a later question that I realized that the method depicted below, which was gone over in class, is pretty different from that in the video to the extent that I got a bit bewildered and confused. While all of this intuitively makes sense to me and Iâ€™m learning along with it, there are many points here where Iâ€™d feel completely lost and confused if not for the solutions video. Therefore, Iâ€™m afraid Iâ€™ll have to just consider myself a â€œ0%â€ on the struggle-report for this whole assignment. But the procedures that we went over in class remain below.<a class="anchor" aria-label="anchor" href="#it-was-only-after-consulting-the-solutions-video-for-a-later-question-that-i-realized-that-the-method-depicted-below-which-was-gone-over-in-class-is-pretty-different-from-that-in-the-video-to-the-extent-that-i-got-a-bit-bewildered-and-confused--while-all-of-this-intuitively-makes-sense-to-me-and-im-learning-along-with-it-there-are-many-points-here-where-id-feel-completely-lost-and-confused-if-not-for-the-solutions-video--therefore-im-afraid-ill-have-to-just-consider-myself-a-0-on-the-struggle-report-for-this-whole-assignment--but-the-procedures-that-we-went-over-in-class-remain-below-"></a>
</h3>
</div>
<div class="section level3">
<h3 id="q1">Q1<a class="anchor" aria-label="anchor" href="#q1"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">make_one_subject_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>

<span class="va">subject_control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>

<span class="va">subnum</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">subject_baseline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>

<span class="va">control</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">subject_baseline</span>, <span class="fl">1</span><span class="op">)</span>

<span class="va">down1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, 
               mean <span class="op">=</span> <span class="va">subject_baseline</span><span class="op">-</span><span class="fl">1</span>,
               sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">down2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, 
               mean <span class="op">=</span> <span class="va">subject_baseline</span><span class="op">-</span><span class="fl">2</span>,
               sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">up1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, 
               mean <span class="op">=</span> <span class="va">subject_baseline</span><span class="op">+</span><span class="fl">1</span>,
               sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">up2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, 
               mean <span class="op">=</span> <span class="va">subject_baseline</span><span class="op">+</span><span class="fl">2</span>,
               sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="op">}</span>

<span class="fu">make_one_subject_data</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="a-more-generalized-function">A More Generalized Function<a class="anchor" aria-label="anchor" href="#a-more-generalized-function"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">one_factor_rm_sim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">nsubs</span>, <span class="va">level_names</span>, <span class="va">level_means</span>, <span class="va">level_sds</span><span class="op">)</span><span class="op">{</span>
  <span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>subject <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nsubs</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">level_names</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span>,
                         IV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">level_names</span>, <span class="va">nsubs</span><span class="op">)</span><span class="op">)</span>,
                         DV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nsubs</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">level_names</span><span class="op">)</span>,
                                  mean <span class="op">=</span> <span class="va">level_means</span>,
                                  sd <span class="op">=</span> <span class="va">level_sds</span><span class="op">)</span>
                         <span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">)</span>
  
<span class="op">}</span>

<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">one_factor_rm_sim</span><span class="op">(</span>nsubs <span class="op">=</span> <span class="fl">6</span>,
                       level_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Down2"</span>, <span class="st">"Down1"</span>, <span class="st">"Control"</span>, <span class="st">"Up1"</span>, <span class="st">"Up2"</span><span class="op">)</span>,
                       level_means <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
                       level_sds <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; [1] -3.5574538 -1.1462591  0.5776767  1.0394796  1.3007571</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="applying-these-function-principles-for-the-assignment">Applying these function principles for the assignment<a class="anchor" aria-label="anchor" href="#applying-these-function-principles-for-the-assignment"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">one_factor_rm_sim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">nsubs</span>,
                              <span class="va">level_names</span>, 
                              <span class="va">level_means</span>, 
                              <span class="va">level_sds</span>,
                              <span class="va">subject_means</span>,
                              <span class="va">subject_sds</span><span class="op">)</span><span class="op">{</span>
  
  <span class="va">shift_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nsubs</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">level_names</span><span class="op">)</span>,
                        mean <span class="op">=</span> <span class="va">subject_means</span>, 
                        sd <span class="op">=</span> <span class="va">subject_sds</span><span class="op">)</span>
  
  <span class="va">shift_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">subject_means</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">level_names</span><span class="op">)</span>, mean <span class="op">=</span> <span class="va">x</span>, sd <span class="op">=</span> <span class="va">subject_sds</span><span class="op">)</span><span class="op">}</span> <span class="op">)</span><span class="op">)</span>
  
  <span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>subect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nsubs</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">level_names</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span>,
                         IV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">level_names</span>, <span class="va">nsubs</span><span class="op">)</span><span class="op">)</span>,
                         DV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nsubs</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">level_names</span><span class="op">)</span>,
                                  mean <span class="op">=</span> <span class="va">level_means</span>,
                                  sd <span class="op">=</span> <span class="va">level_sds</span><span class="op">)</span> <span class="op">+</span> <span class="va">shift_factor</span>
                         <span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">)</span>
  
<span class="op">}</span>

<span class="co">### It is after this point that my record from our in-class coverage of this assignment finished, and I ended up getting totally lost and needing to check the solutions video. </span>

<span class="co">### The all-encompassing struggle-report: Anything before this point is N/A, as I followed it along with our in-class coverage, and everything after this is at best a 20% on how much I needed to consult the video. This all intuitively makes sense to me and I learned through this exercise, however- as far as the generalization assignment goes- there were numerous points from question C and onwards that I really just would not have known what functions to use or create. </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="follow-along-with-in-class-examples">Follow-along with in-class examples<a class="anchor" aria-label="anchor" href="#follow-along-with-in-class-examples"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>

<span class="va">e1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">Subject</span>, <span class="op">~</span><span class="va">Drug_A</span>, <span class="op">~</span><span class="va">Placebo</span>, <span class="op">~</span><span class="va">Drug_B</span>,
        <span class="st">"s1"</span>, <span class="fl">124</span>, <span class="fl">108</span>, <span class="fl">104</span>,
        <span class="st">"s2"</span>, <span class="fl">105</span>, <span class="fl">107</span>, <span class="fl">100</span>,
        <span class="st">"s3"</span>,<span class="fl">107</span>,<span class="fl">90</span>,<span class="fl">100</span>,
        <span class="st">"s4"</span>,<span class="fl">109</span>,<span class="fl">89</span>,<span class="fl">93</span>,
        <span class="st">"s5"</span>,<span class="fl">94</span>,<span class="fl">105</span>,<span class="fl">89</span>,
        <span class="st">"s6"</span>,<span class="fl">121</span>,<span class="fl">71</span>,<span class="fl">84</span><span class="op">)</span> 

<span class="va">e1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">e1</span>,
                   cols <span class="op">=</span> <span class="op">!</span><span class="va">Subject</span>,
                   names_to <span class="op">=</span> <span class="st">"IV"</span>,
                   values_to <span class="op">=</span> <span class="st">"Latency"</span><span class="op">)</span>

<span class="va">e1</span> <span class="op">&lt;-</span> <span class="va">e1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Subject <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Subject</span><span class="op">)</span>,
         IV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">IV</span><span class="op">)</span><span class="op">)</span>

<span class="va">aov_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">Latency</span> <span class="op">~</span> <span class="va">IV</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">Error</a></span><span class="op">(</span><span class="va">Subject</span><span class="op">)</span>, data<span class="op">=</span><span class="va">e1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aov_out</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: Subject</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; Residuals  5    750     150               </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: Within</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)  </span>
<span class="co">#&gt; IV         2    900     450    3.75 0.0609 .</span>
<span class="co">#&gt; Residuals 10   1200     120                 </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">e2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">Subject</span>, <span class="op">~</span><span class="va">r1</span>, <span class="op">~</span><span class="va">r2</span>, <span class="op">~</span><span class="va">r3</span>, <span class="op">~</span><span class="va">r4</span>, <span class="op">~</span><span class="va">r5</span>, <span class="op">~</span><span class="va">r6</span>,
        <span class="st">"s1"</span>,<span class="fl">30</span>,<span class="fl">18</span>,<span class="fl">21</span>,<span class="fl">15</span>,<span class="fl">18</span>,<span class="fl">12</span>,
        <span class="st">"s2"</span>,<span class="fl">21</span>,<span class="fl">23</span>,<span class="fl">16</span>,<span class="fl">17</span>,<span class="fl">13</span>,<span class="fl">12</span>,
        <span class="st">"s3"</span>,<span class="fl">19</span>,<span class="fl">21</span>,<span class="fl">13</span>,<span class="fl">15</span>,<span class="fl">13</span>,<span class="fl">9</span>,
        <span class="st">"s4"</span>,<span class="fl">19</span>,<span class="fl">19</span>,<span class="fl">16</span>,<span class="fl">9</span>,<span class="fl">11</span>,<span class="fl">10</span>,
        <span class="st">"s5"</span>,<span class="fl">21</span>,<span class="fl">16</span>,<span class="fl">12</span>,<span class="fl">15</span>,<span class="fl">9</span>,<span class="fl">11</span>,
        <span class="st">"s6"</span>,<span class="fl">22</span>,<span class="fl">17</span>,<span class="fl">14</span>,<span class="fl">12</span>,<span class="fl">10</span>,<span class="fl">9</span>,
        <span class="st">"s7"</span>,<span class="fl">19</span>,<span class="fl">20</span>,<span class="fl">17</span>,<span class="fl">10</span>,<span class="fl">13</span>,<span class="fl">5</span>,
        <span class="st">"s8"</span>,<span class="fl">17</span>,<span class="fl">18</span>,<span class="fl">11</span>,<span class="fl">11</span>,<span class="fl">9</span>,<span class="fl">12</span>
        <span class="op">)</span> 

<span class="va">e2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">e2</span>,cols <span class="op">=</span> <span class="op">!</span><span class="va">Subject</span>,
                   names_to <span class="op">=</span> <span class="st">"Rank"</span>,
                   values_to <span class="op">=</span> <span class="st">"Recall"</span><span class="op">)</span>

<span class="va">e2</span> <span class="op">&lt;-</span> <span class="va">e2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Subject <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Subject</span><span class="op">)</span>,
         Rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Rank</span><span class="op">)</span><span class="op">)</span>

<span class="va">aov_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">Recall</span> <span class="op">~</span> <span class="va">Rank</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">Error</a></span><span class="op">(</span><span class="va">Subject</span><span class="op">)</span>, data<span class="op">=</span> <span class="va">e2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aov_out</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: Subject</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; Residuals  7    168      24               </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: Within</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span>
<span class="co">#&gt; Rank       5    720     144      24 2.09e-10 ***</span>
<span class="co">#&gt; Residuals 35    210       6                     </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">godden_baddeley</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">Subjects</span>,<span class="op">~</span><span class="va">LearningPlace</span>,<span class="op">~</span><span class="va">TestingPlace</span>,<span class="op">~</span><span class="va">Recall</span>,
        <span class="st">"s1"</span>,<span class="st">"On Land"</span>,<span class="st">"On Land"</span>,<span class="fl">34</span>,
        <span class="st">"s2"</span>,<span class="st">"On Land"</span>,<span class="st">"On Land"</span>,<span class="fl">37</span>,
        <span class="st">"s3"</span>,<span class="st">"On Land"</span>,<span class="st">"On Land"</span>,<span class="fl">27</span>,
        <span class="st">"s4"</span>,<span class="st">"On Land"</span>,<span class="st">"On Land"</span>,<span class="fl">43</span>,
        <span class="st">"s5"</span>,<span class="st">"On Land"</span>,<span class="st">"On Land"</span>,<span class="fl">44</span>,
        <span class="st">"s1"</span>,<span class="st">"On Land"</span>,<span class="st">"Under Sea"</span>,<span class="fl">18</span>,
        <span class="st">"s2"</span>,<span class="st">"On Land"</span>,<span class="st">"Under Sea"</span>,<span class="fl">21</span>,
        <span class="st">"s3"</span>,<span class="st">"On Land"</span>,<span class="st">"Under Sea"</span>,<span class="fl">25</span>,
        <span class="st">"s4"</span>,<span class="st">"On Land"</span>,<span class="st">"Under Sea"</span>,<span class="fl">37</span>,
        <span class="st">"s5"</span>,<span class="st">"On Land"</span>,<span class="st">"Under Sea"</span>,<span class="fl">34</span>,
        <span class="st">"s1"</span>,<span class="st">"Under Sea"</span>,<span class="st">"On Land"</span>,<span class="fl">14</span>,
        <span class="st">"s2"</span>,<span class="st">"Under Sea"</span>,<span class="st">"On Land"</span>,<span class="fl">21</span>,
        <span class="st">"s3"</span>,<span class="st">"Under Sea"</span>,<span class="st">"On Land"</span>,<span class="fl">31</span>,
        <span class="st">"s4"</span>,<span class="st">"Under Sea"</span>,<span class="st">"On Land"</span>,<span class="fl">27</span>,
        <span class="st">"s5"</span>,<span class="st">"Under Sea"</span>,<span class="st">"On Land"</span>,<span class="fl">32</span>,
        <span class="st">"s1"</span>,<span class="st">"Under Sea"</span>,<span class="st">"Under Sea"</span>,<span class="fl">22</span>,
        <span class="st">"s2"</span>,<span class="st">"Under Sea"</span>,<span class="st">"Under Sea"</span>,<span class="fl">25</span>,
        <span class="st">"s3"</span>,<span class="st">"Under Sea"</span>,<span class="st">"Under Sea"</span>,<span class="fl">33</span>,
        <span class="st">"s4"</span>,<span class="st">"Under Sea"</span>,<span class="st">"Under Sea"</span>,<span class="fl">33</span>,
        <span class="st">"s5"</span>,<span class="st">"Under Sea"</span>,<span class="st">"Under Sea"</span>,<span class="fl">42</span>
        <span class="op">)</span>

<span class="va">godden_baddeley</span> <span class="op">&lt;-</span> <span class="va">godden_baddeley</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Subjects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Subjects</span><span class="op">)</span>,
         LearningPlace <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">LearningPlace</span><span class="op">)</span>,
         TestingPlace <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">TestingPlace</span><span class="op">)</span><span class="op">)</span>

<span class="va">aov_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">Recall</span> <span class="op">~</span> <span class="va">LearningPlace</span><span class="op">*</span><span class="va">TestingPlace</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">Error</a></span><span class="op">(</span><span class="va">Subjects</span><span class="op">/</span><span class="op">(</span><span class="va">LearningPlace</span><span class="op">*</span><span class="va">TestingPlace</span><span class="op">)</span><span class="op">)</span>, <span class="va">godden_baddeley</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aov_out</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: Subjects</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; Residuals  4    680     170               </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: Subjects:LearningPlace</span>
<span class="co">#&gt;               Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; LearningPlace  1     80      80       2   0.23</span>
<span class="co">#&gt; Residuals      4    160      40               </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: Subjects:TestingPlace</span>
<span class="co">#&gt;              Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; TestingPlace  1     20      20     2.5  0.189</span>
<span class="co">#&gt; Residuals     4     32       8               </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: Subjects:LearningPlace:TestingPlace</span>
<span class="co">#&gt;                            Df Sum Sq Mean Sq F value Pr(&gt;F)  </span>
<span class="co">#&gt; LearningPlace:TestingPlace  1    320     320      20 0.0111 *</span>
<span class="co">#&gt; Residuals                   4     64      16                 </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">godden_baddeley</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">TestingPlace</span>,
                            y<span class="op">=</span><span class="va">Recall</span>,
                            shape<span class="op">=</span><span class="va">LearningPlace</span>,
                            group<span class="op">=</span><span class="va">LearningPlace</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"summary"</span>,fun<span class="op">=</span><span class="st">"mean"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"summary"</span>,fun<span class="op">=</span><span class="st">"mean"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">12</span><span class="op">)</span></code></pre></div>
<p><img src="Lab9_RMAnova_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### Re. Sphericity</span>

<span class="va">textbook</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">S</span>, <span class="op">~</span><span class="va">a1</span>, <span class="op">~</span><span class="va">a2</span>, <span class="op">~</span><span class="va">a3</span>, <span class="op">~</span><span class="va">a4</span>,
        <span class="st">"s1"</span>,<span class="fl">76</span>,<span class="fl">64</span>,<span class="fl">34</span>,<span class="fl">26</span>,
        <span class="st">"s2"</span>,<span class="fl">60</span>,<span class="fl">48</span>,<span class="fl">46</span>,<span class="fl">30</span>,
        <span class="st">"s3"</span>,<span class="fl">58</span>,<span class="fl">34</span>,<span class="fl">32</span>,<span class="fl">28</span>,
        <span class="st">"s4"</span>,<span class="fl">46</span>,<span class="fl">46</span>,<span class="fl">32</span>,<span class="fl">28</span>,
        <span class="st">"s5"</span>,<span class="fl">30</span>,<span class="fl">18</span>,<span class="fl">36</span>,<span class="fl">28</span>
        <span class="op">)</span> 

<span class="va">textbook</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 x 4</span></span>
<span class="co">#&gt;      a1    a2    a3    a4</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    76    64    34    26</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    60    48    46    30</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    58    34    32    28</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>    46    46    32    28</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>    30    18    36    28</span>

<span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">textbook</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;     a1  a2 a3 a4</span>
<span class="co">#&gt; a1 294 258  8 -8</span>
<span class="co">#&gt; a2 258 294  8 -8</span>
<span class="co">#&gt; a3   8   8 34  6</span>
<span class="co">#&gt; a4  -8  -8  6  2</span>

<span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">textbook</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  a1  a2  a3  a4 </span>
<span class="co">#&gt; 138 138  14  -2</span>

<span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">textbook</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">textbook</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  a1  a2  a3  a4 </span>
<span class="co">#&gt;  66  66 -58 -74</span>

<span class="va">cov_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></span><span class="op">(</span><span class="va">textbook</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>
<span class="va">col_mean_matrix</span> <span class="op">&lt;-</span> <span class="va">cov_matrix</span><span class="op">*</span><span class="fl">0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">cov_matrix</span><span class="op">)</span>
<span class="va">row_mean_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">cov_matrix</span><span class="op">*</span><span class="fl">0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">cov_matrix</span><span class="op">)</span><span class="op">)</span>
<span class="va">dc_matrix</span> <span class="op">&lt;-</span> <span class="va">cov_matrix</span> <span class="op">-</span> <span class="va">col_mean_matrix</span> <span class="op">-</span><span class="va">row_mean_matrix</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">cov_matrix</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">dc_matrix</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">dc_matrix</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dc_matrix</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.4459613</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">textbook</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span><span class="op">~</span><span class="va">S</span>, <span class="op">~</span><span class="va">a1</span>, <span class="op">~</span><span class="va">a2</span>, <span class="op">~</span><span class="va">a3</span>, <span class="op">~</span><span class="va">a4</span>,
        <span class="st">"s1"</span>,<span class="fl">76</span>,<span class="fl">64</span>,<span class="fl">34</span>,<span class="fl">26</span>,
        <span class="st">"s2"</span>,<span class="fl">60</span>,<span class="fl">48</span>,<span class="fl">46</span>,<span class="fl">30</span>,
        <span class="st">"s3"</span>,<span class="fl">58</span>,<span class="fl">34</span>,<span class="fl">32</span>,<span class="fl">28</span>,
        <span class="st">"s4"</span>,<span class="fl">46</span>,<span class="fl">46</span>,<span class="fl">32</span>,<span class="fl">28</span>,
        <span class="st">"s5"</span>,<span class="fl">30</span>,<span class="fl">18</span>,<span class="fl">36</span>,<span class="fl">28</span>
        <span class="op">)</span> 

<span class="va">wide_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">textbook</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>
<span class="va">aov_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">wide_data</span> <span class="op">~</span><span class="fl">1</span><span class="op">)</span>
<span class="va">rm_factor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'a1'</span>,<span class="st">'a2'</span>,<span class="st">'a3'</span>,<span class="st">'a4'</span><span class="op">)</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span>
<span class="co">#&gt; Warning: package 'car' was built under R version 4.1.3</span>
<span class="co">#&gt; Loading required package: carData</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'car'</span>
<span class="co">#&gt; The following object is masked from 'package:dplyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     recode</span>
<span class="va">new_anova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">aov_model</span>, 
                   idata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">rm_factor</span><span class="op">)</span>,
                   idesign <span class="op">=</span> <span class="op">~</span><span class="va">rm_factor</span>,
                   type<span class="op">=</span><span class="st">"III"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">new_anova</span>,multivariate<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Univariate Type III Repeated-Measures ANOVA Assuming Sphericity</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;             Sum Sq num Df Error SS den Df  F value    Pr(&gt;F)    </span>
<span class="co">#&gt; (Intercept)  32000      1     1152      4 111.1111 0.0004582 ***</span>
<span class="co">#&gt; rm_factor     1800      3     1344     12   5.3571 0.0142330 *  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Mauchly Tests for Sphericity</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;           Test statistic p-value</span>
<span class="co">#&gt; rm_factor       0.088557 0.27931</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Greenhouse-Geisser and Huynh-Feldt Corrections</span>
<span class="co">#&gt;  for Departure from Sphericity</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;            GG eps Pr(&gt;F[GG])  </span>
<span class="co">#&gt; rm_factor 0.44596    0.05999 .</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;              HF eps Pr(&gt;F[HF])</span>
<span class="co">#&gt; rm_factor 0.5871795 0.04114125</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">pf</a></span><span class="op">(</span>q<span class="op">=</span> <span class="fl">5.3571</span>, df1<span class="op">=</span> <span class="fl">3</span>, df2<span class="op">=</span> <span class="fl">12</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.01423341</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">GG_df1</span> <span class="op">=</span> <span class="op">(</span><span class="fl">4</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">.44596</span>
<span class="va">GG_df2</span> <span class="op">=</span> <span class="op">(</span><span class="fl">4</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">5</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span><span class="fl">.44596</span>

<span class="va">GG_df1</span>
<span class="co">#&gt; [1] 1.33788</span>
<span class="va">GG_df2</span>
<span class="co">#&gt; [1] 5.35152</span>

<span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">pf</a></span><span class="op">(</span>q<span class="op">=</span> <span class="fl">5.3571</span>, df1<span class="op">=</span> <span class="va">GG_df1</span>, df2<span class="op">=</span> <span class="va">GG_df2</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.05999576</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">long_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">textbook</span>,cols <span class="op">=</span> <span class="op">!</span><span class="va">S</span>,
                   names_to <span class="op">=</span> <span class="st">"IV"</span>,
                   values_to <span class="op">=</span> <span class="st">"DV"</span><span class="op">)</span>

<span class="va">long_data</span> <span class="op">&lt;-</span> <span class="va">long_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>S <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span>,
         IV <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">IV</span><span class="op">)</span><span class="op">)</span>

<span class="va">aov_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">DV</span> <span class="op">~</span> <span class="va">IV</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">Error</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span>, data<span class="op">=</span> <span class="va">long_data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aov_out</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: S</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; Residuals  4   1152     288               </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: Within</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)  </span>
<span class="co">#&gt; IV         3   1800     600   5.357 0.0142 *</span>
<span class="co">#&gt; Residuals 12   1344     112                 </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">DBSStats2Labs</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Dan Siegel.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
